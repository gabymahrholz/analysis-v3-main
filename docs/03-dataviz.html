<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="description" content="Level 2 UG Analysis book">
<title>Analysis - 3&nbsp; Data viz</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./04-prob-binom-one-sample.html" rel="next">
<link href="./02-wrangling.html" rel="prev">
<link href="./images/logos/logo_analysis.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.13.0/css/all.css">
<link rel="stylesheet" href="include/booktem.css">
<link rel="stylesheet" href="include/webex.css">
<link rel="stylesheet" href="include/glossary.css">
<link rel="stylesheet" href="include/style.css">
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./03-dataviz.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data viz</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Analysis</a> 
        <div class="sidebar-tools-main">
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
<li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=%7Curl%7C">
              <i class="bi bi-bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=%7Curl%7C">
              <i class="bi bi-bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=%7Curl%7C">
              <i class="bi bi-bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
</div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Projects, R Markdown, and Data Wrangling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-wrangling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data wrangling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-dataviz.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data viz</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-prob-binom-one-sample.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Revisiting probability and introduction to NHST</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-independent.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Independent t-test</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-paired.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Paired t-test</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-apes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">APES - Alpha, Power, Effect Sizes, Sample Size</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-correlation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Correlations</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-simple-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Simple regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-multiple-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Multiple regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-one-way-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">One-way ANOVA</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-factorial-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Factorial ANOVA</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix-a-installing-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Installing R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix-b-updating-packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Updating R, RStudio, and packages</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix-c-exporting-server.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Exporting files from the server</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix-d-symbols.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Symbols</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix-x-How-to-cite-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Citing R and RStudio</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix-y-license.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">License</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#intended-learning-outcomes" id="toc-intended-learning-outcomes" class="nav-link active" data-scroll-target="#intended-learning-outcomes">Intended Learning Outcomes</a></li>
  <li><a href="#individual-walkthrough" id="toc-individual-walkthrough" class="nav-link" data-scroll-target="#individual-walkthrough"><span style="color: #EBA347; text-transform: uppercase;">Individual Walkthrough</span></a></li>
  <li><a href="#building-pots" id="toc-building-pots" class="nav-link" data-scroll-target="#building-pots"><span class="header-section-number">3.1</span> Building pots</a></li>
  <li><a href="#activity-1-set-up" id="toc-activity-1-set-up" class="nav-link" data-scroll-target="#activity-1-set-up"><span class="header-section-number">3.2</span> Activity 1: Set-up</a></li>
  <li><a href="#activity-2-download-the-data" id="toc-activity-2-download-the-data" class="nav-link" data-scroll-target="#activity-2-download-the-data"><span class="header-section-number">3.3</span> Activity 2: Download the data</a></li>
  <li><a href="#activity-3-load-in-the-libraries-and-read-in-the-data" id="toc-activity-3-load-in-the-libraries-and-read-in-the-data" class="nav-link" data-scroll-target="#activity-3-load-in-the-libraries-and-read-in-the-data"><span class="header-section-number">3.4</span> Activity 3: Load in the libraries and read in the data</a></li>
  <li>
<a href="#activity-4-data-wrangling" id="toc-activity-4-data-wrangling" class="nav-link" data-scroll-target="#activity-4-data-wrangling"><span class="header-section-number">3.5</span> Activity 4: Data wrangling</a>
  <ul class="collapse">
<li><a href="#ipip-50" id="toc-ipip-50" class="nav-link" data-scroll-target="#ipip-50"><span class="header-section-number">3.5.1</span> IPIP 50</a></li>
  <li><a href="#sd3" id="toc-sd3" class="nav-link" data-scroll-target="#sd3"><span class="header-section-number">3.5.2</span> SD3</a></li>
  <li><a href="#pvq-rr" id="toc-pvq-rr" class="nav-link" data-scroll-target="#pvq-rr"><span class="header-section-number">3.5.3</span> PVQ-RR</a></li>
  </ul>
</li>
  <li>
<a href="#sec-appropriate-plot" id="toc-sec-appropriate-plot" class="nav-link" data-scroll-target="#sec-appropriate-plot"><span class="header-section-number">3.6</span> Which plot is the appropriate plot???</a>
  <ul class="collapse">
<li><a href="#one-categorical-variable" id="toc-one-categorical-variable" class="nav-link" data-scroll-target="#one-categorical-variable"><span class="header-section-number">3.6.1</span> One categorical variable</a></li>
  <li><a href="#activity-5-make-the-column-plot-pretty" id="toc-activity-5-make-the-column-plot-pretty" class="nav-link" data-scroll-target="#activity-5-make-the-column-plot-pretty">Activity 5: Make the column plot pretty</a></li>
  <li><a href="#two-categorical-variables" id="toc-two-categorical-variables" class="nav-link" data-scroll-target="#two-categorical-variables"><span class="header-section-number">3.6.2</span> Two categorical variables</a></li>
  <li><a href="#one-continuous-variable" id="toc-one-continuous-variable" class="nav-link" data-scroll-target="#one-continuous-variable"><span class="header-section-number">3.6.3</span> One continuous variable</a></li>
  <li><a href="#one-continuous-and-one-categorical-grouping-variable" id="toc-one-continuous-and-one-categorical-grouping-variable" class="nav-link" data-scroll-target="#one-continuous-and-one-categorical-grouping-variable"><span class="header-section-number">3.6.4</span> One continuous and one categorical grouping variable</a></li>
  <li><a href="#activity-6-recreating-a-boxplot-from-jakob-et-al.-2019" id="toc-activity-6-recreating-a-boxplot-from-jakob-et-al.-2019" class="nav-link" data-scroll-target="#activity-6-recreating-a-boxplot-from-jakob-et-al.-2019">Activity 6: Recreating a boxplot from Jakob et al.&nbsp;(2019)</a></li>
  <li><a href="#two-continuous" id="toc-two-continuous" class="nav-link" data-scroll-target="#two-continuous"><span class="header-section-number">3.6.5</span> Two continuous</a></li>
  </ul>
</li>
  <li><a href="#save-your-plots" id="toc-save-your-plots" class="nav-link" data-scroll-target="#save-your-plots"><span class="header-section-number">3.7</span> Save your plots</a></li>
  <li><a href="#pair-coding-in-the-lab" id="toc-pair-coding-in-the-lab" class="nav-link" data-scroll-target="#pair-coding-in-the-lab"><span style="color: #EBA347; text-transform: uppercase;">Pair-coding in the lab</span></a></li>
  <li><a href="#test-your-knowledge" id="toc-test-your-knowledge" class="nav-link" data-scroll-target="#test-your-knowledge"><span style="color: #EBA347; text-transform: uppercase;">Test your knowledge</span></a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="sec-dataviz" class="quarto-section-identifier"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data viz</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><section id="intended-learning-outcomes" class="level2 unnumbered"><h2 class="unnumbered anchored" data-anchor-id="intended-learning-outcomes">Intended Learning Outcomes</h2>
<p>By the end of this chapter you should be able to:</p>
<ul>
<li>a</li>
<li>b</li>
<li>Be able to create an appropriate for your data</li>
</ul></section><section id="individual-walkthrough" class="level2 unnumbered"><h2 class="unnumbered anchored" data-anchor-id="individual-walkthrough"><span style="color: #EBA347; text-transform: uppercase;">Individual Walkthrough</span></h2>
</section><section id="building-pots" class="level2" data-number="3.1"><h2 data-number="3.1" class="anchored" data-anchor-id="building-pots">
<span class="header-section-number">3.1</span> Building pots</h2>
<p>We are using the package <code>ggplot2</code> to create data visualisations. It’s part of the tidyverse package. Actually, most people call th package <code>ggplot</code> but it’s official name is <code>ggplot2</code>.</p>
<div class="grid">
<div class="g-col-5">
<p><strong>ggplot2</strong> uses a layered grammar of graphics, in which plots are built up in a series of layers. You would start with a base layer (opening ggplot), adding <strong>data</strong> and <strong>aesthetics</strong>, and selecting the <strong>geometries</strong> for plot.</p>
<p>These first 3 layers will give you the most simple version of a complete plot, but you could add other layers to make the plots pretty by using <strong>scales</strong>, <strong>facets</strong>, <strong>coordinates</strong>, <strong>labels</strong> and <strong>themes</strong>.</p>
</div>
<div class="g-col-7">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="images/gglayers.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">gg layers <a href="https://metricsf20.classes.ryansafner.com/slides/1.3-slides#20" target="_blank">(Presentation by Ryan Safner)</a></figcaption></figure>
</div>
</div>
</div>
<p>To give you a brief overview of the layering system, let’s use the package <code>palmerpenguins</code> (<a href="https://allisonhorst.github.io/palmerpenguins/" target="_blank">https://allisonhorst.github.io/palmerpenguins/</a>). It contains data about bill length and depth, flipper length, and body mass, etc.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">head</span>(penguins)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 8%">
<col style="width: 11%">
<col style="width: 16%">
<col style="width: 15%">
<col style="width: 20%">
<col style="width: 13%">
<col style="width: 7%">
<col style="width: 5%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">species</th>
<th style="text-align: left;">island</th>
<th style="text-align: right;">bill_length_mm</th>
<th style="text-align: right;">bill_depth_mm</th>
<th style="text-align: right;">flipper_length_mm</th>
<th style="text-align: right;">body_mass_g</th>
<th style="text-align: left;">sex</th>
<th style="text-align: right;">year</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Adelie</td>
<td style="text-align: left;">Torgersen</td>
<td style="text-align: right;">39.1</td>
<td style="text-align: right;">18.7</td>
<td style="text-align: right;">181</td>
<td style="text-align: right;">3750</td>
<td style="text-align: left;">male</td>
<td style="text-align: right;">2007</td>
</tr>
<tr class="even">
<td style="text-align: left;">Adelie</td>
<td style="text-align: left;">Torgersen</td>
<td style="text-align: right;">39.5</td>
<td style="text-align: right;">17.4</td>
<td style="text-align: right;">186</td>
<td style="text-align: right;">3800</td>
<td style="text-align: left;">female</td>
<td style="text-align: right;">2007</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Adelie</td>
<td style="text-align: left;">Torgersen</td>
<td style="text-align: right;">40.3</td>
<td style="text-align: right;">18.0</td>
<td style="text-align: right;">195</td>
<td style="text-align: right;">3250</td>
<td style="text-align: left;">female</td>
<td style="text-align: right;">2007</td>
</tr>
<tr class="even">
<td style="text-align: left;">Adelie</td>
<td style="text-align: left;">Torgersen</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">2007</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Adelie</td>
<td style="text-align: left;">Torgersen</td>
<td style="text-align: right;">36.7</td>
<td style="text-align: right;">19.3</td>
<td style="text-align: right;">193</td>
<td style="text-align: right;">3450</td>
<td style="text-align: left;">female</td>
<td style="text-align: right;">2007</td>
</tr>
<tr class="even">
<td style="text-align: left;">Adelie</td>
<td style="text-align: left;">Torgersen</td>
<td style="text-align: right;">39.3</td>
<td style="text-align: right;">20.6</td>
<td style="text-align: right;">190</td>
<td style="text-align: right;">3650</td>
<td style="text-align: left;">male</td>
<td style="text-align: right;">2007</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Let’s build a basic scatterplot to show the relationship between <code>flipper_length</code> and <code>body_mass</code>. We will customise plots further later on in the individual plots. This is just a quick overview of the different layers.</p>
<ul>
<li>Layer 1 creates a plot base to built up upon.</li>
<li>Layer 2 adds the <code>data</code> and some <code>aesthetics</code>
<ul>
<li>data is first argument</li>
<li>aesthetics are added via the mapping argument. There you define your variables to be added (such as x, or x and y) and allows you specify overall properties like the colour of grouping variables etc.</li>
</ul>
</li>
<li>Layer 3 adds the geometries or <code>geom_?</code> for short. This tells ggplot in which style we want to plot the data points. Remember to add these layers with a <code>+</code> rather than a pipe <code>%&gt;%</code>. You can add multiple geoms if you wish, e.g., building a violin-boxplot</li>
<li>Layer 4 adds the <code>scale_?</code> functions which can help you customise the aesthetics, such as changing colour. You can do much more with scales, but we’ll get to that later.</li>
<li>Layer 5 introduces <code>facets</code>, such as <code>facet_wrap()</code> which allows you to add another dimension to the data output by showing the relationship you are interested in for each level of a categorical variable.</li>
<li>Layer 6 - coordinates: <code>coord_cartesian()</code> controls the limits for the x- and y-axes (arguments <code>xlim</code> and <code>ylim</code>). Changing those allows you to zoom in or out of your plot.</li>
<li>Layer 7 helps you to modify axes labels.</li>
<li>Layer 8 controls the general style of a ggplot (e.g., background colour, size of text, borders, etc.). R comes with a few pre-defined ones (like <code>theme_classic</code>, <code>theme_bw</code>, <code>theme_minimal</code>, <code>theme_light</code>).</li>
</ul>
<p>Click on the tabs below to see how each layer contributes to refining the plot.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="layers">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">Layer 1</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Layer 2</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Layer 3</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false">Layer 4</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-5" role="tab" aria-controls="tabset-1-5" aria-selected="false">Layer 5</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-6" role="tab" aria-controls="tabset-1-6" aria-selected="false">Layer 6</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-7" role="tab" aria-controls="tabset-1-7" aria-selected="false">Layer 7</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-8" role="tab" aria-controls="tabset-1-8" aria-selected="false">Layer 8</a></li>
</ul>
<div class="tab-content" data-group="layers">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="fu">ggplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="03-dataviz_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>We don’t see much here. It’s basically an empty plot layer.</p>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> penguins, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>body_mass_g, <span class="at">y=</span>flipper_length_mm))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="03-dataviz_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>You won’t see any data points yet, because we haven’t specified how we want to display the data points. But we mapped in the aesthetics, that we want to plot variable body mass on the x-axis and flipper length on the y-axis. This also adds the axes titles and the values and break points of the axes.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>You won’t need to add <code>data =</code> or <code>mapping =</code> if you keep those arguments in exactly that order. Likewise, the first column name you enter within the <code>aes()</code> function will always be interpreted as x, and the second as y, so you could omit them if you wish.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="fu">ggplot</span>(penguins, <span class="fu">aes</span>(body_mass_g, flipper_length_mm))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>will give you the same output as the code above.</p>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> penguins, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>body_mass_g, <span class="at">y=</span>flipper_length_mm, <span class="at">colour=</span>sex)) <span class="sc">+</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="03-dataviz_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Here we are telling ggplot that we want a scatterplot added. There is a warning displayed showing that rows were removed because of missing values.</p>
<p>The argument <code>colour</code> adds colour to the points according to a grouping variable (in this case sex). If you want all of the points to be black (i.e.&nbsp;only represent 2 rather than 3 dimensions of the data), leave the <code>colour</code> argument out.</p>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> penguins, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>body_mass_g, <span class="at">y=</span>flipper_length_mm, <span class="at">colour=</span>sex)) <span class="sc">+</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb7-3"><a href="#cb7-3"></a>  <span class="co"># changes colour palette</span></span>
<span id="cb7-4"><a href="#cb7-4"></a>  <span class="fu">scale_colour_brewer</span>(<span class="at">palette =</span> <span class="st">"Dark2"</span>) <span class="sc">+</span> </span>
<span id="cb7-5"><a href="#cb7-5"></a>  <span class="co"># add breaks from 2500 to 6500 in increasing steps of 500</span></span>
<span id="cb7-6"><a href="#cb7-6"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">2500</span>, <span class="at">to =</span> <span class="dv">6500</span>, <span class="at">by =</span> <span class="dv">500</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 11 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="03-dataviz_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>The <code>scale_?</code> functions allow us to change the colour palette of the plot or the axes breaks etc. You could change the name of the axis in <code>scale_x_continuous()</code> as well or leave it for Layer 7.</p>
</div>
<div id="tabset-1-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-5-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> penguins, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>body_mass_g, <span class="at">y=</span>flipper_length_mm, <span class="at">colour=</span>sex)) <span class="sc">+</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb9-3"><a href="#cb9-3"></a>  <span class="fu">scale_colour_brewer</span>(<span class="at">palette =</span> <span class="st">"Dark2"</span>) <span class="sc">+</span> </span>
<span id="cb9-4"><a href="#cb9-4"></a>  <span class="co"># split main plot up into different subplots by species </span></span>
<span id="cb9-5"><a href="#cb9-5"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> species) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 11 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="03-dataviz_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Here we are faceting this plot out for the individual species.</p>
</div>
<div id="tabset-1-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-6-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> penguins, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>body_mass_g, <span class="at">y=</span>flipper_length_mm, <span class="at">colour=</span>sex)) <span class="sc">+</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb11-3"><a href="#cb11-3"></a>  <span class="fu">scale_colour_brewer</span>(<span class="at">palette =</span> <span class="st">"Dark2"</span>) <span class="sc">+</span> </span>
<span id="cb11-4"><a href="#cb11-4"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> species) <span class="sc">+</span></span>
<span id="cb11-5"><a href="#cb11-5"></a>  <span class="co"># limits the range of the y axis</span></span>
<span id="cb11-6"><a href="#cb11-6"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">250</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 11 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="03-dataviz_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Changing the limits of the y axis to zoom in or out of the plot. If you wanted to the same for the x axis, you would add an argument <code>xlim</code> to the <code>coord_cartesian()</code> function.</p>
</div>
<div id="tabset-1-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-7-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> penguins, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>body_mass_g, <span class="at">y=</span>flipper_length_mm, <span class="at">colour=</span>sex)) <span class="sc">+</span></span>
<span id="cb13-2"><a href="#cb13-2"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3"></a>  <span class="fu">scale_colour_brewer</span>(<span class="at">palette =</span> <span class="st">"Dark2"</span>) <span class="sc">+</span> </span>
<span id="cb13-4"><a href="#cb13-4"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> species) <span class="sc">+</span></span>
<span id="cb13-5"><a href="#cb13-5"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Body Mass (in g)"</span>, <span class="co"># labels the x axis</span></span>
<span id="cb13-6"><a href="#cb13-6"></a>       <span class="at">y =</span> <span class="st">"Flipper length (in mm)"</span>, <span class="co"># labels the y axis</span></span>
<span id="cb13-7"><a href="#cb13-7"></a>       <span class="at">colour =</span> <span class="st">"Sex"</span>) <span class="co"># labels the grouping variable in the legend</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 11 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="03-dataviz_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>You can change the axes labels via the <code>labs()</code> function or include that step when modifying the scales (i.e.&nbsp;in the <code>scale_x_continuous()</code> function).</p>
</div>
<div id="tabset-1-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-8-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> penguins, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>body_mass_g, <span class="at">y=</span>flipper_length_mm, <span class="at">colour=</span>sex)) <span class="sc">+</span></span>
<span id="cb15-2"><a href="#cb15-2"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb15-3"><a href="#cb15-3"></a>  <span class="fu">scale_colour_brewer</span>(<span class="at">palette =</span> <span class="st">"Dark2"</span>) <span class="sc">+</span> </span>
<span id="cb15-4"><a href="#cb15-4"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> species) <span class="sc">+</span></span>
<span id="cb15-5"><a href="#cb15-5"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Body Mass (in g)"</span>, </span>
<span id="cb15-6"><a href="#cb15-6"></a>       <span class="at">y =</span> <span class="st">"Flipper length (in mm)"</span>,</span>
<span id="cb15-7"><a href="#cb15-7"></a>       <span class="at">colour =</span> <span class="st">"Sex"</span>) <span class="sc">+</span></span>
<span id="cb15-8"><a href="#cb15-8"></a>  <span class="co"># add a theme</span></span>
<span id="cb15-9"><a href="#cb15-9"></a>  <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 11 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="03-dataviz_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p><code>theme_classic()</code> is applied to change the overall appearance of the plot.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>You need to stick to the first 3 layers to get your base plot. Everything else is optional meaning you don’t have to use all 8 layers in a plot. And layers 4-8 can be added in a random order whereas layers 1-3 are fixed.</p>
</div>
</div>
</section><section id="activity-1-set-up" class="level2" data-number="3.2"><h2 data-number="3.2" class="anchored" data-anchor-id="activity-1-set-up">
<span class="header-section-number">3.2</span> Activity 1: Set-up</h2>
<p>Ok, let’s move on to our data for today. But first, we need to set up a new project and create an Rmd:</p>
<ul>
<li>Create a new project and name it something meaningful (e.g., “2A_chapter3”, or “03_data_viz”). See <a href="01-basics.html#sec-project"><span>Section&nbsp;1.2</span></a> if you need some guidance.</li>
<li>Create a new Rmd and save it to your project folder. Name it something meaningful (e.g., “chapter_03”, “03_data_viz.Rmd”). See <a href="01-basics.html#sec-rmd"><span>Section&nbsp;1.3</span></a> if you need some guidance.</li>
<li>Delete everything below line 12 (keep the set-up code chunk)</li>
</ul></section><section id="activity-2-download-the-data" class="level2" data-number="3.3"><h2 data-number="3.3" class="anchored" data-anchor-id="activity-2-download-the-data">
<span class="header-section-number">3.3</span> Activity 2: Download the data</h2>
<ul>
<li>Download the data for today: <a href="data/data_ch3.zip" title="download">data_ch3</a>. There are 2 csv files contained in the zip-folder you just downloaded. One is the data file (<code>hp_data_modified.csv</code>) and the other is the <code>questionnaire_codebook</code> for the main 3 questionnaires used in the dataset.</li>
<li>Unzip the zip folder so that all data files, the Rmd and the project are in the same folder (see image below)</li>
</ul>
<p>If you set it up correctly, your folder should look like this:</p>
<div id="img-data-viz" class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="images/data_viz_setup.PNG" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Folder on your computer (left)</figcaption></figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="images/files_plane_data_viz.PNG" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Files pane in RStudio (right)</figcaption></figure>
</div>
</div>
</div>
</div>
<section id="info-about-the-data" class="level5 unnumbered"><h5 class="unnumbered anchored" data-anchor-id="info-about-the-data">Info about the data</h5>
<p><strong>Citation</strong></p>
<blockquote class="blockquote">
<p>Jakob, L., Garcia-Garzon, E., Jarke, H., &amp; Dablander, F. (2019). The Science Behind the Magic? The Relation of the Harry Potter “Sorting Hat Quiz” to Personality and Human Values. <em>Collabra: Psychology, 5</em>(1), 31. <a href="https://doi.org/10.1525/collabra.240" target="_blank">https://doi.org/10.1525/collabra.240</a></p>
</blockquote>
<p><strong>Abstract</strong></p>
<blockquote class="blockquote">
<p>The Harry Potter series describes the adventures of a boy and his peers in a fictional world at the “Hogwarts School of Witchcraft and Wizardry”. In the series, pupils get appointed to one of four groups (Houses) at the beginning of their education based on their personality traits. The author of the books has constructed an online questionnaire that allows fans to find out their House affiliation. Crysel, Cook, Schember, and Webster (2015) argued that being sorted into a particular Hogwarts House through the Sorting Hat Quiz is related to empirically established personality traits. We replicated their study while improving on sample size, methods, and analysis. Although our results are similar, effect sizes are small overall, which attenuates the claims by Crysel et al.&nbsp;The effect vanishes when restricting the analysis to participants who desired, but were not sorted into a particular House. On a theoretical level, we extend previous research by also analysing the relation of the Hogwarts Houses to Schwartz’s Basic Human Values but find only moderate or no relations.</p>
</blockquote>
<p><strong>Changes made to the dataset</strong></p>
<ul>
<li>The dataset is a reduced version of the original dataset.</li>
<li>The values in the IPIP 50 were turned into character responses</li>
<li>All reverse-coded items were already corrected in the original dataset, so we reversed that process.</li>
<li>The PVQ-RR has been revised repeatedly over the years (and is somewhat confusing tbh). To keep it simple, we opted to code the 57 items into a 12-value category structure as proposed by Giménez and Tamajón (2019; <a href="https://doi.org/10.1016/j.heliyon.2019.e01797" target="_blank">https://doi.org/10.1016/j.heliyon.2019.e01797</a>). This is not in line with Jakob et al.&nbsp;(2019), who used a 10-value categorisation approach.</li>
</ul></section></section><section id="activity-3-load-in-the-libraries-and-read-in-the-data" class="level2" data-number="3.4"><h2 data-number="3.4" class="anchored" data-anchor-id="activity-3-load-in-the-libraries-and-read-in-the-data">
<span class="header-section-number">3.4</span> Activity 3: Load in the libraries and read in the data</h2>
<p>Given the codebook is also in a csv format, you might want to read in the codebook as well. It might help us speed up data wrangling process.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="do">## packages </span></span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb17-3"><a href="#cb17-3"></a></span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="do">## data</span></span>
<span id="cb17-5"><a href="#cb17-5"></a>hp_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"hp_data_modified.csv"</span>)</span>
<span id="cb17-6"><a href="#cb17-6"></a>codebook <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"hp_questionnaire_codebook.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="familiarise-yourself-with-the-data-structure" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="familiarise-yourself-with-the-data-structure">Familiarise yourself with the data structure</h4>
<p>As we said in <a href="01-basics.html#sec-familiarise"><span>Section&nbsp;1.6</span></a>, it is always recommended to glimpse at the data to see how many variables and observations there are in the dataset and what kind of data type they are.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Using glimpse to view the data. The output is pretty long, therefore it’s hidden. Click to see the output.
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="fu">glimpse</span>(hp_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 988
Columns: 159
$ PP_ID                &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15…
$ books                &lt;chr&gt; "Harry Potter and the Philosopher's Stone,Harry P…
$ language_books       &lt;chr&gt; "English", "German and English", "Both English an…
$ movies               &lt;chr&gt; "Harry Potter and the Philosopher's Stone,Harry P…
$ language_movies      &lt;chr&gt; "English", "German and English", "Both English an…
$ Sorting_completed_YN &lt;chr&gt; "Yes", "No", "Yes", "Yes", "Yes", "Yes", "No", "Y…
$ Sorting_house        &lt;chr&gt; "Ravenclaw", "Gryffindor", "Gryffindor", "Slyther…
$ Sorting_house_wish   &lt;chr&gt; "Ravenclaw", "Ravenclaw", "Ravenclaw", "Slytherin…
$ age                  &lt;dbl&gt; 21, 22, 27, 21, 20, 27, 26, 29, 23, 24, 25, 33, 2…
$ country              &lt;chr&gt; "Germany", "Germany", "France", "Norway", "Chile"…
$ language             &lt;chr&gt; "german", "German", "French", "Norwegian", "Spani…
$ occupation           &lt;chr&gt; "Student", "Student", "Employed", "Student", "Stu…
$ gender               &lt;chr&gt; "Female", "Female", "Female", "Male", "Female", "…
$ Bravery              &lt;chr&gt; "Gryffindor", "Gryffindor", "Gryffindor", "Gryffi…
$ Hardwork             &lt;chr&gt; "Ravenclaw", "Ravenclaw", "Hufflepuff", "Hufflepu…
$ Intelligence         &lt;chr&gt; "Ravenclaw", "Ravenclaw", "Ravenclaw", "Ravenclaw…
$ Ambition             &lt;chr&gt; "Slytherin", "Slytherin", "Slytherin", "Slytherin…
$ Daring               &lt;chr&gt; "Gryffindor", "Hufflepuff", "Gryffindor", "Gryffi…
$ Dedication           &lt;chr&gt; "Ravenclaw", "Slytherin", "Hufflepuff", "Hufflepu…
$ Knowledge            &lt;chr&gt; "Ravenclaw", "Ravenclaw", "Ravenclaw", "Ravenclaw…
$ Cunning              &lt;chr&gt; "Slytherin", "Hufflepuff", "Slytherin", "Slytheri…
$ Extraverted          &lt;chr&gt; "Hufflepuff", "Hufflepuff", "Hufflepuff", "Gryffi…
$ Agreeable            &lt;chr&gt; "Hufflepuff", "Gryffindor", "Hufflepuff", "Huffle…
$ Clever               &lt;chr&gt; "Ravenclaw", "Ravenclaw", "Ravenclaw", "Ravenclaw…
$ Manipulative         &lt;chr&gt; "Slytherin", "Slytherin", "Slytherin", "Slytherin…
$ IPIP_01              &lt;chr&gt; "moderately accurate", "neither accurate nor inac…
$ IPIP_02              &lt;chr&gt; "very inaccurate", "moderately accurate", "very i…
$ IPIP_03              &lt;chr&gt; "moderately inaccurate", "very accurate", "modera…
$ IPIP_04              &lt;chr&gt; "moderately inaccurate", "neither accurate nor in…
$ IPIP_05              &lt;chr&gt; "very accurate", "moderately accurate", "very acc…
$ IPIP_06              &lt;chr&gt; "moderately inaccurate", "neither accurate nor in…
$ IPIP_07              &lt;chr&gt; "very accurate", "moderately inaccurate", "very a…
$ IPIP_08              &lt;chr&gt; "moderately accurate", "very inaccurate", "modera…
$ IPIP_09              &lt;chr&gt; "moderately accurate", "neither accurate nor inac…
$ IPIP_10              &lt;chr&gt; "very inaccurate", "very inaccurate", "very inacc…
$ IPIP_11              &lt;chr&gt; "moderately accurate", "moderately inaccurate", "…
$ IPIP_12              &lt;chr&gt; "very inaccurate", "moderately inaccurate", "very…
$ IPIP_13              &lt;chr&gt; "neither accurate nor inaccurate", "very accurate…
$ IPIP_14              &lt;chr&gt; "very inaccurate", "moderately accurate", "modera…
$ IPIP_15              &lt;chr&gt; "moderately accurate", "neither accurate nor inac…
$ IPIP_16              &lt;chr&gt; "neither accurate nor inaccurate", "moderately in…
$ IPIP_17              &lt;chr&gt; "moderately accurate", "neither accurate nor inac…
$ IPIP_18              &lt;chr&gt; "moderately inaccurate", "moderately inaccurate",…
$ IPIP_19              &lt;chr&gt; "neither accurate nor inaccurate", "moderately in…
$ IPIP_20              &lt;chr&gt; "moderately inaccurate", "very inaccurate", "very…
$ IPIP_21              &lt;chr&gt; "very inaccurate", "moderately accurate", "modera…
$ IPIP_22              &lt;chr&gt; "moderately inaccurate", "moderately inaccurate",…
$ IPIP_23              &lt;chr&gt; "very inaccurate", "moderately inaccurate", "very…
$ IPIP_24              &lt;chr&gt; "neither accurate nor inaccurate", "moderately in…
$ IPIP_25              &lt;chr&gt; "moderately accurate", "very accurate", "moderate…
$ IPIP_26              &lt;chr&gt; "very inaccurate", "moderately inaccurate", "mode…
$ IPIP_27              &lt;chr&gt; "moderately inaccurate", "moderately accurate", "…
$ IPIP_28              &lt;chr&gt; "moderately accurate", "moderately accurate", "ve…
$ IPIP_29              &lt;chr&gt; "moderately inaccurate", "moderately accurate", "…
$ IPIP_30              &lt;chr&gt; "very inaccurate", "moderately inaccurate", "very…
$ IPIP_31              &lt;chr&gt; "very inaccurate", "moderately accurate", "modera…
$ IPIP_32              &lt;chr&gt; "moderately inaccurate", "moderately inaccurate",…
$ IPIP_33              &lt;chr&gt; "moderately inaccurate", "very accurate", "modera…
$ IPIP_34              &lt;chr&gt; "moderately inaccurate", "moderately inaccurate",…
$ IPIP_35              &lt;chr&gt; "moderately accurate", "moderately accurate", "mo…
$ IPIP_36              &lt;chr&gt; "moderately accurate", "moderately inaccurate", "…
$ IPIP_37              &lt;chr&gt; "moderately accurate", "moderately accurate", "mo…
$ IPIP_38              &lt;chr&gt; "neither accurate nor inaccurate", "moderately in…
$ IPIP_39              &lt;chr&gt; "very inaccurate", "moderately inaccurate", "neit…
$ IPIP_40              &lt;chr&gt; "moderately accurate", "moderately accurate", "ve…
$ IPIP_41              &lt;chr&gt; "moderately inaccurate", "moderately accurate", "…
$ IPIP_42              &lt;chr&gt; "moderately accurate", "neither accurate nor inac…
$ IPIP_43              &lt;chr&gt; "moderately inaccurate", "moderately inaccurate",…
$ IPIP_44              &lt;chr&gt; "moderately inaccurate", "moderately inaccurate",…
$ IPIP_45              &lt;chr&gt; "very accurate", "moderately accurate", "very acc…
$ IPIP_46              &lt;chr&gt; "very accurate", "moderately inaccurate", "neithe…
$ IPIP_47              &lt;chr&gt; "moderately inaccurate", "moderately accurate", "…
$ IPIP_48              &lt;chr&gt; "moderately inaccurate", "moderately accurate", "…
$ IPIP_49              &lt;chr&gt; "moderately inaccurate", "moderately inaccurate",…
$ IPIP_50              &lt;chr&gt; "moderately accurate", "moderately accurate", "ve…
$ SD_M1                &lt;dbl&gt; 3, 4, 3, 4, 2, 3, 3, 3, 4, 2, 4, 3, 4, 4, 3, 4, 4…
$ SD_M2                &lt;dbl&gt; 2, 3, 2, 5, 1, 2, 1, 2, 1, 2, 2, 4, 4, 4, 4, 2, 4…
$ SD_M3                &lt;dbl&gt; 2, 3, 1, 4, 2, 2, 2, 3, 3, 2, 4, 1, 3, 2, 3, 3, 2…
$ SD_M4                &lt;dbl&gt; 2, 2, 3, 4, 3, 3, 2, 4, 2, 2, 3, 4, 4, 4, 3, 2, 2…
$ SD_M5                &lt;dbl&gt; 2, 2, 1, 4, 2, 2, 1, 1, 1, 1, 2, 1, 4, 3, 2, 2, 3…
$ SD_M6                &lt;dbl&gt; 1, 3, 1, 5, 3, 3, 3, 4, 1, 2, 3, 1, 5, 1, 4, 3, 3…
$ SD_M7                &lt;dbl&gt; 3, 5, 4, 5, 2, 5, 4, 4, 5, 2, 3, 1, 5, 4, 4, 5, 5…
$ SD_M8                &lt;dbl&gt; 1, 3, 2, 2, 3, 1, 1, 3, 1, 2, 3, 1, 2, 1, 3, 1, 2…
$ SD_M9                &lt;dbl&gt; 4, 4, 2, 4, 1, 4, 2, 2, 1, 3, 3, 1, 4, 5, 4, 1, 3…
$ SD_N1                &lt;dbl&gt; 1, 3, 4, 4, 2, 3, 2, 1, 3, 3, 1, 1, 2, 2, 4, 3, 1…
$ SD_N2                &lt;dbl&gt; 4, 1, 3, 3, 2, 3, 4, 4, 5, 3, 5, 5, 4, 2, 2, 5, 4…
$ SD_N3                &lt;dbl&gt; 3, 2, 2, 2, 2, 2, 1, 3, 1, 1, 2, 1, 3, 2, 2, 1, 5…
$ SD_N4                &lt;dbl&gt; 2, 2, 2, 1, 2, 2, 2, 5, 2, 1, 3, 1, 3, 1, 4, 1, 2…
$ SD_N5                &lt;dbl&gt; 1, 2, 2, 4, 3, 2, 1, 4, 1, 3, 2, 1, 4, 2, 2, 1, 4…
$ SD_N6                &lt;dbl&gt; 4, 1, 2, 4, 4, 4, 2, 5, 5, 3, 3, 1, 4, 1, 3, 4, 2…
$ SD_N7                &lt;dbl&gt; 1, 3, 2, 3, 1, 1, 1, 4, 1, 3, 2, 1, 2, 4, 4, 1, 3…
$ SD_N8                &lt;dbl&gt; 4, 3, 3, 2, 4, 3, 3, 4, 3, 4, 4, 3, 2, 2, 2, 4, 1…
$ SD_N9                &lt;dbl&gt; 1, 4, 2, 4, 3, 2, 3, 2, 1, 4, 4, 1, 5, 2, 3, 3, 4…
$ SD_P1                &lt;dbl&gt; 1, 3, 2, 2, 1, 1, 1, 1, 1, 1, 3, 1, 3, 1, 4, 2, 2…
$ SD_P2                &lt;dbl&gt; 2, 3, 1, 4, 3, 4, 4, 4, 2, 2, 3, 3, 2, 2, 1, 3, 2…
$ SD_P3                &lt;dbl&gt; 1, 2, 1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 2, 1, 4, 2, 1…
$ SD_P4                &lt;dbl&gt; 1, 2, 3, 2, 1, 1, 1, 1, 1, 1, 2, 1, 2, 2, 3, 1, 1…
$ SD_P5                &lt;dbl&gt; 3, 4, 1, 4, 1, 2, 3, 4, 1, 3, 2, 1, 4, 4, 3, 1, 1…
$ SD_P6                &lt;dbl&gt; 3, 3, 1, 4, 1, 2, 2, 2, 1, 1, 2, 1, 3, 1, 3, 2, 1…
$ SD_P7                &lt;dbl&gt; 5, 5, 4, 1, 5, 5, 5, 5, 5, 2, 5, 5, 2, 5, 2, 5, 2…
$ SD_P8                &lt;dbl&gt; 1, 1, 3, 2, 3, 2, 1, 3, 1, 2, 1, 1, 1, 1, 3, 3, 3…
$ SD_P9                &lt;dbl&gt; 1, 2, 1, 3, 1, 1, 1, 1, 1, 2, 2, 1, 1, 1, 2, 2, 4…
$ PVQ_01               &lt;dbl&gt; 5, 5, 5, 5, 6, 6, 4, 6, 4, 4, 5, 5, 5, 6, 6, 4, 6…
$ PVQ_02               &lt;dbl&gt; 2, 6, 2, 4, 5, 2, 4, 4, 2, 3, 4, 4, 6, 4, 4, 6, 6…
$ PVQ_03               &lt;dbl&gt; 4, 6, 3, 5, 6, 4, 4, 5, 3, 4, 5, 4, 5, 3, 4, 4, 3…
$ PVQ_04               &lt;dbl&gt; 2, 5, 4, 3, 3, 4, 5, 6, 5, 4, 5, 5, 4, 5, 4, 3, 2…
$ PVQ_05               &lt;dbl&gt; 5, 5, 4, 3, 5, 5, 5, 6, 4, 5, 6, 6, 6, 5, 3, 5, 4…
$ PVQ_06               &lt;dbl&gt; 1, 3, 2, 5, 3, 3, 2, 2, 1, 2, 2, 3, 3, 2, 3, 4, 4…
$ PVQ_07               &lt;dbl&gt; 5, 5, 5, 3, 4, 5, 4, 5, 6, 4, 4, 4, 2, 5, 3, 5, 1…
$ PVQ_08               &lt;dbl&gt; 3, 5, 4, 4, 6, 6, 3, 6, 2, 4, 6, 6, 3, 3, 2, 6, 3…
$ PVQ_09               &lt;dbl&gt; 4, 4, 5, 2, 3, 4, 4, 3, 5, 3, 5, 2, 5, 3, 3, 6, 3…
$ PVQ_10               &lt;dbl&gt; 4, 4, 6, 2, 5, 3, 4, 6, 4, 4, 5, 4, 4, 5, 6, 3, 5…
$ PVQ_11               &lt;dbl&gt; 3, 6, 6, 6, 6, 6, 5, 5, 6, 5, 5, 6, 6, 6, 5, 4, 4…
$ PVQ_12               &lt;dbl&gt; 1, 2, 1, 6, 2, 2, 2, 1, 1, 2, 3, 4, 3, 3, 1, 5, 3…
$ PVQ_13               &lt;dbl&gt; 3, 5, 3, 5, 4, 4, 5, 5, 2, 3, 4, 4, 5, 5, 3, 6, 4…
$ PVQ_14               &lt;dbl&gt; 5, 6, 5, 5, 6, 6, 6, 6, 4, 5, 6, 6, 6, 5, 6, 5, 4…
$ PVQ_15               &lt;dbl&gt; 2, 3, 2, 2, 3, 4, 3, 5, 6, 4, 3, 2, 2, 2, 2, 2, 3…
$ PVQ_16               &lt;dbl&gt; 4, 6, 5, 6, 6, 4, 5, 6, 5, 5, 5, 6, 6, 6, 6, 5, 5…
$ PVQ_17               &lt;dbl&gt; 4, 6, 5, 6, 6, 4, 4, 6, 6, 5, 4, 5, 5, 6, 4, 4, 5…
$ PVQ_18               &lt;dbl&gt; 1, 2, 2, 3, 2, 2, 2, 4, 1, 3, 2, 1, 1, 2, 2, 2, 4…
$ PVQ_19               &lt;dbl&gt; 4, 4, 5, 4, 5, 6, 6, 5, 5, 3, 4, 5, 5, 6, 6, 3, 5…
$ PVQ_20               &lt;dbl&gt; 1, 5, 1, 6, 2, 2, 2, 4, 1, 2, 3, 4, 5, 2, 2, 5, 4…
$ PVQ_21               &lt;dbl&gt; 2, 3, 3, 0, 5, 4, 1, 0, 2, 4, 5, 0, 4, 1, 3, 6, 1…
$ PVQ_22               &lt;dbl&gt; 5, 2, 3, 2, 2, 3, 3, 5, 6, 3, 4, 3, 4, 3, 2, 3, 1…
$ PVQ_23               &lt;dbl&gt; 4, 5, 6, 5, 6, 5, 4, 5, 5, 5, 5, 6, 6, 6, 6, 4, 4…
$ PVQ_24               &lt;dbl&gt; 2, 3, 2, 5, 2, 3, 4, 5, 4, 3, 3, 4, 5, 3, 3, 3, 4…
$ PVQ_25               &lt;dbl&gt; 5, 5, 6, 6, 6, 6, 5, 5, 5, 5, 4, 6, 5, 5, 5, 5, 4…
$ PVQ_26               &lt;dbl&gt; 3, 6, 3, 6, 4, 4, 5, 2, 1, 4, 5, 5, 6, 3, 5, 6, 4…
$ PVQ_27               &lt;dbl&gt; 5, 6, 6, 6, 5, 5, 6, 5, 5, 5, 5, 5, 5, 6, 5, 5, 2…
$ PVQ_28               &lt;dbl&gt; 3, 3, 6, 3, 5, 2, 2, 4, 4, 4, 5, 3, 4, 3, 6, 3, 2…
$ PVQ_29               &lt;dbl&gt; 1, 4, 2, 5, 2, 2, 1, 1, 1, 2, 3, 3, 4, 4, 5, 4, 4…
$ PVQ_30               &lt;dbl&gt; 3, 4, 5, 3, 5, 3, 4, 5, 4, 4, 5, 4, 5, 5, 4, 4, 5…
$ PVQ_31               &lt;dbl&gt; 1, 3, 2, 3, 2, 4, 2, 4, 6, 2, 4, 1, 2, 2, 4, 5, 4…
$ PVQ_32               &lt;dbl&gt; 4, 5, 3, 5, 5, 3, 3, 5, 5, 3, 4, 5, 5, 5, 5, 5, 5…
$ PVQ_33               &lt;dbl&gt; 1, 2, 2, 3, 4, 3, 2, 2, 2, 2, 1, 2, 1, 3, 1, 1, 3…
$ PVQ_34               &lt;dbl&gt; 4, 5, 6, 4, 6, 6, 5, 6, 5, 4, 5, 6, 6, 6, 5, 5, 5…
$ PVQ_35               &lt;dbl&gt; 1, 5, 2, 3, 4, 2, 2, 2, 1, 4, 3, 4, 5, 3, 2, 6, 5…
$ PVQ_36               &lt;dbl&gt; 5, 6, 4, 5, 6, 4, 5, 3, 3, 4, 4, 5, 5, 4, 5, 5, 5…
$ PVQ_37               &lt;dbl&gt; 5, 5, 4, 3, 6, 5, 5, 6, 4, 5, 5, 6, 6, 6, 5, 6, 6…
$ PVQ_38               &lt;dbl&gt; 5, 4, 5, 2, 5, 3, 6, 4, 6, 4, 5, 4, 4, 4, 3, 5, 4…
$ PVQ_39               &lt;dbl&gt; 4, 5, 5, 3, 6, 5, 4, 6, 6, 4, 5, 6, 5, 6, 6, 4, 6…
$ PVQ_40               &lt;dbl&gt; 1, 2, 2, 3, 3, 3, 2, 4, 1, 2, 2, 1, 2, 3, 1, 1, 4…
$ PVQ_41               &lt;dbl&gt; 2, 2, 2, 4, 2, 3, 1, 2, 1, 2, 2, 3, 4, 4, 4, 3, 3…
$ PVQ_42               &lt;dbl&gt; 1, 5, 2, 2, 2, 4, 4, 3, 6, 2, 2, 1, 2, 3, 2, 5, 2…
$ PVQ_43               &lt;dbl&gt; 5, 5, 5, 4, 6, 5, 4, 4, 5, 4, 3, 5, 5, 5, 5, 5, 6…
$ PVQ_44               &lt;dbl&gt; 1, 2, 1, 4, 2, 2, 1, 1, 1, 2, 1, 1, 3, 2, 1, 4, 1…
$ PVQ_45               &lt;dbl&gt; 2, 3, 4, 2, 5, 6, 2, 5, 2, 4, 6, 6, 5, 3, 3, 6, 3…
$ PVQ_46               &lt;dbl&gt; 4, 4, 3, 3, 6, 3, 3, 2, 3, 3, 4, 1, 4, 4, 5, 2, 3…
$ PVQ_47               &lt;dbl&gt; 3, 4, 5, 4, 5, 5, 4, 4, 5, 5, 4, 5, 4, 4, 5, 1, 2…
$ PVQ_48               &lt;dbl&gt; 4, 3, 5, 6, 4, 2, 2, 4, 6, 4, 4, 5, 6, 5, 5, 4, 4…
$ PVQ_49               &lt;dbl&gt; 4, 5, 5, 5, 3, 3, 2, 4, 6, 4, 4, 3, 5, 5, 4, 6, 3…
$ PVQ_50               &lt;dbl&gt; 3, 4, 2, 3, 4, 2, 2, 3, 1, 4, 4, 3, 3, 3, 1, 6, 3…
$ PVQ_51               &lt;dbl&gt; 5, 2, 2, 2, 3, 3, 3, 3, 6, 3, 4, 4, 3, 4, 3, 3, 3…
$ PVQ_52               &lt;dbl&gt; 4, 5, 4, 5, 6, 5, 5, 6, 4, 5, 5, 6, 5, 6, 3, 6, 4…
$ PVQ_53               &lt;dbl&gt; 2, 3, 2, 4, 3, 3, 3, 2, 2, 3, 4, 3, 3, 2, 1, 4, 4…
$ PVQ_54               &lt;dbl&gt; 3, 2, 3, 2, 3, 3, 4, 5, 4, 4, 4, 3, 3, 5, 5, 2, 3…
$ PVQ_55               &lt;dbl&gt; 5, 5, 5, 5, 5, 6, 5, 4, 5, 5, 4, 4, 5, 5, 4, 4, 4…
$ PVQ_56               &lt;dbl&gt; 4, 6, 5, 6, 6, 5, 5, 6, 5, 4, 5, 6, 5, 6, 6, 5, 4…
$ PVQ_57               &lt;dbl&gt; 4, 6, 5, 5, 5, 4, 4, 6, 4, 4, 4, 5, 5, 4, 4, 5, 4…</code></pre>
</div>
</div>
</div>
</div>
</div>
</section></section><section id="activity-4-data-wrangling" class="level2" data-number="3.5"><h2 data-number="3.5" class="anchored" data-anchor-id="activity-4-data-wrangling">
<span class="header-section-number">3.5</span> Activity 4: Data wrangling</h2>
<p>Before we can plot anything, we need to get the data into the right shape.</p>
<p>The data for the questionnaires looks fairly complex. It’s best to split it up into separate data objects to wrangle the questionnaire data. The next sections will wrangle the data separately for the</p>
<ul>
<li>IPIP 50 - International Personality Item Pool (Goldberg et al., 2006)</li>
<li>SD 3 - Short Dark Triad (Jones &amp; Paulhus, 2013)</li>
<li>PVQ-RR - Portrait Values Questionnaire (Schwartz et al., 2012).</li>
</ul>
<section id="ipip-50" class="level3" data-number="3.5.1"><h3 data-number="3.5.1" class="anchored" data-anchor-id="ipip-50">
<span class="header-section-number">3.5.1</span> IPIP 50</h3>
<p><strong>Overall goal</strong> is to compute a score for each of the personality dimension (Agreeableness, Conscientiousness, Emotional Stability, Extraversion, Intellect) for each participant. So how do we do this?</p>
<p><strong>First, check the data (data object and codebook). What is going on here?</strong> IPIP items are in data type <select class="webex-select"><option value="blank"></option>
<option value="x">numeric</option>
<option value="answer">character</option>
<option value="x">logical</option>
<option value="x">factor</option></select> and there is <select class="webex-select"><option value="blank"></option>
<option value="x">no</option>
<option value="answer">some</option></select> reverse-scoring for the IPIP items.</p>
<section id="step-1" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="step-1">Step 1</h4>
<p>Select the Participant id and the items of the IPIP.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>hp_ipip <span class="ot">&lt;-</span> hp_data <span class="sc">%&gt;%</span> </span>
<span id="cb20-2"><a href="#cb20-2"></a>  <span class="fu">select</span>(PP_ID, IPIP_01<span class="sc">:</span>IPIP_50)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="step-2" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="step-2">Step 2</h4>
<p>Next, items are in wide format which is not helpful. We need them in long format.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>hp_ipip <span class="ot">&lt;-</span> hp_ipip <span class="sc">%&gt;%</span> </span>
<span id="cb21-2"><a href="#cb21-2"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>PP_ID, <span class="co"># all coloumns apart from PP_ID</span></span>
<span id="cb21-3"><a href="#cb21-3"></a>               <span class="at">names_to =</span> <span class="st">"IPIP_items"</span>,</span>
<span id="cb21-4"><a href="#cb21-4"></a>               <span class="at">values_to =</span> <span class="st">"IPIP_response"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="step-3" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="step-3">Step 3</h4>
<p>Now, we need information which items are reverse-coded and modify how they are scored. We could code this ourselves like we did in <strong>[LINK TO DATA SECTION IN CHAPTER 2]</strong>, or we could take a shortcut since the information is already stored in the codebook.</p>
<p>We won’t need all the info from codebook, so we need to select the relevant columns (<code>Questionnaire_Item</code>, <code>Forward- or Reverse-coded item</code>, <code>Dimension</code>) first before joining our <code>hp_ipip</code> with <code>codebook_reduced</code>. Retaining the Dimension will help later on with calculating scores for each subscale.</p>
<p>Notice how there are spaces in the variable name <code>Forward- or Reverse-coded item</code> which R has to wrap in single backticks to be able to process. Maybe better to change that variable name to <code>FW_RV</code> during selection so that it won’t give us a headache later on.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>codebook_reduced <span class="ot">&lt;-</span> codebook <span class="sc">%&gt;%</span> </span>
<span id="cb22-2"><a href="#cb22-2"></a>  <span class="fu">select</span>(Questionnaire_Item, <span class="at">FW_RV =</span> <span class="st">`</span><span class="at">Forward- or Reverse-coded item</span><span class="st">`</span>, Dimension)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we can join those 2 dataframes together using <code>left_join()</code> or an <code>inner_join()</code>, which means only information for the IPIP items will be considered.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>hp_ipip_codebook <span class="ot">&lt;-</span> <span class="fu">left_join</span>(hp_ipip, codebook_reduced)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in `left_join()`:
! `by` must be supplied when `x` and `y` have no common variables.
ℹ Use `cross_join()` to perform a cross-join.</code></pre>
</div>
</div>
<p>Oh, an error message. Meh. It says <code>x and y have no common variables</code>. Ohhh, because when we pivoted <code>hp_ipip</code>, we named the column with the IPIP items <code>IPIP_items</code> whereas information in <code>codebook_reduced</code> is stored in a column called <code>Questionnaire_Item</code>. To fix that, we could either</p>
<ul>
<li>change the column name in <code>hp_ipip</code> during pivoting, i.e., setting <code>names_to = "Questionnaire_Item"</code>
</li>
<li>change the column name in <code>codebook_reduced</code> during selection of the variables, i.e., <code>select(IPIP_items = Questionnaire_Item, etc.)</code> but that would only help us for IPIP items, not for the SD or the PVQ later on (so not really an option)</li>
<li>use a workaround and define the different column names in the “by” argument</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>hp_ipip_codebook <span class="ot">&lt;-</span> <span class="fu">left_join</span>(hp_ipip, codebook_reduced, <span class="at">by =</span> <span class="fu">join_by</span>(IPIP_items <span class="sc">==</span> Questionnaire_Item))</span>
<span id="cb25-2"><a href="#cb25-2"></a></span>
<span id="cb25-3"><a href="#cb25-3"></a><span class="fu">glimpse</span>(hp_ipip_codebook)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 49,400
Columns: 5
$ PP_ID         &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…
$ IPIP_items    &lt;chr&gt; "IPIP_01", "IPIP_02", "IPIP_03", "IPIP_04", "IPIP_05", "…
$ IPIP_response &lt;chr&gt; "moderately accurate", "very inaccurate", "moderately in…
$ FW_RV         &lt;chr&gt; "Forward", "Reverse", "Forward", "Reverse", "Forward", "…
$ Dimension     &lt;chr&gt; "Extraversion", "Agreeableness", "Conscientiousness", "E…</code></pre>
</div>
</div>
</section><section id="step-4" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="step-4">Step 4</h4>
<p>Now it’s getting tricky. Reverse-coding.</p>
<p>What we need to do is:</p>
<ul>
<li>turn the character values into numbers and</li>
<li>make sure that we the correct those numbers for the reverse-coded items</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>hp_ipip_final <span class="ot">&lt;-</span> hp_ipip_codebook <span class="sc">%&gt;%</span> </span>
<span id="cb27-2"><a href="#cb27-2"></a>  <span class="co"># regardless of FW_RV item, we'll recode very inaccurate as 1, moderately inaccurate as 2, etc</span></span>
<span id="cb27-3"><a href="#cb27-3"></a>  <span class="fu">mutate</span>(<span class="at">IPIP_values =</span> <span class="fu">case_when</span>(</span>
<span id="cb27-4"><a href="#cb27-4"></a>    IPIP_response <span class="sc">==</span> <span class="st">"very inaccurate"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb27-5"><a href="#cb27-5"></a>    IPIP_response <span class="sc">==</span> <span class="st">"moderately inaccurate"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb27-6"><a href="#cb27-6"></a>    IPIP_response <span class="sc">==</span> <span class="st">"neither accurate nor inaccurate"</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb27-7"><a href="#cb27-7"></a>    IPIP_response <span class="sc">==</span> <span class="st">"moderately accurate"</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb27-8"><a href="#cb27-8"></a>    IPIP_response <span class="sc">==</span> <span class="st">"very accurate"</span> <span class="sc">~</span> <span class="dv">5</span>,</span>
<span id="cb27-9"><a href="#cb27-9"></a>    <span class="at">.default =</span> <span class="cn">NA</span></span>
<span id="cb27-10"><a href="#cb27-10"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb27-11"><a href="#cb27-11"></a>  <span class="co"># now we are reverse-scoring items. If it's a reverse coded item, we want the corrected score be 6 minus the IPIP_value</span></span>
<span id="cb27-12"><a href="#cb27-12"></a>  <span class="fu">mutate</span>(<span class="at">IPIP_values_corrected =</span> <span class="fu">case_when</span>(</span>
<span id="cb27-13"><a href="#cb27-13"></a>    FW_RV <span class="sc">==</span> <span class="st">"Reverse"</span> <span class="sc">~</span> <span class="dv">6</span><span class="sc">-</span>IPIP_values,</span>
<span id="cb27-14"><a href="#cb27-14"></a>    <span class="at">.default =</span> IPIP_values</span>
<span id="cb27-15"><a href="#cb27-15"></a>  ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Check it worked
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Always good to double check to see if it worked. Either look at it, or create an output with distinct values.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>distinct_values <span class="ot">&lt;-</span> hp_ipip_final <span class="sc">%&gt;%</span> </span>
<span id="cb28-2"><a href="#cb28-2"></a>  <span class="fu">distinct</span>(IPIP_response, FW_RV, IPIP_values_corrected) <span class="sc">%&gt;%</span> </span>
<span id="cb28-3"><a href="#cb28-3"></a>  <span class="fu">arrange</span>(FW_RV, <span class="fu">desc</span>(IPIP_values_corrected))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Alternative solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We took 2 steps above to turn character into numeric values and recode those according to whether they were reverse -scored. However, we could have done this in one step:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>hp_ipip_final_v2 <span class="ot">&lt;-</span> hp_ipip_codebook <span class="sc">%&gt;%</span> </span>
<span id="cb29-2"><a href="#cb29-2"></a>  <span class="fu">mutate</span>(<span class="at">IPIP_values_corrected =</span> <span class="fu">case_when</span>(</span>
<span id="cb29-3"><a href="#cb29-3"></a>    IPIP_response <span class="sc">==</span> <span class="st">"very inaccurate"</span> <span class="sc">&amp;</span> FW_RV <span class="sc">==</span> <span class="st">"Forward"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb29-4"><a href="#cb29-4"></a>    IPIP_response <span class="sc">==</span> <span class="st">"moderately inaccurate"</span> <span class="sc">&amp;</span> FW_RV <span class="sc">==</span> <span class="st">"Forward"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb29-5"><a href="#cb29-5"></a>    IPIP_response <span class="sc">==</span> <span class="st">"moderately accurate"</span> <span class="sc">&amp;</span> FW_RV <span class="sc">==</span> <span class="st">"Forward"</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb29-6"><a href="#cb29-6"></a>    IPIP_response <span class="sc">==</span> <span class="st">"very accurate"</span> <span class="sc">&amp;</span> FW_RV <span class="sc">==</span> <span class="st">"Forward"</span> <span class="sc">~</span> <span class="dv">5</span>,</span>
<span id="cb29-7"><a href="#cb29-7"></a>    IPIP_response <span class="sc">==</span> <span class="st">"neither accurate nor inaccurate"</span> <span class="sc">~</span> <span class="dv">3</span>, <span class="do">## doesn't need to be recoded because 3 is 3 for both FW and RV items</span></span>
<span id="cb29-8"><a href="#cb29-8"></a>    IPIP_response <span class="sc">==</span> <span class="st">"very inaccurate"</span> <span class="sc">&amp;</span> FW_RV <span class="sc">==</span> <span class="st">"Reverse"</span> <span class="sc">~</span> <span class="dv">5</span>,</span>
<span id="cb29-9"><a href="#cb29-9"></a>    IPIP_response <span class="sc">==</span> <span class="st">"moderately inaccurate"</span> <span class="sc">&amp;</span> FW_RV <span class="sc">==</span> <span class="st">"Reverse"</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb29-10"><a href="#cb29-10"></a>    IPIP_response <span class="sc">==</span> <span class="st">"moderately accurate"</span> <span class="sc">&amp;</span> FW_RV <span class="sc">==</span> <span class="st">"Reverse"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb29-11"><a href="#cb29-11"></a>    IPIP_response <span class="sc">==</span> <span class="st">"very accurate"</span> <span class="sc">&amp;</span> FW_RV <span class="sc">==</span> <span class="st">"Reverse"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb29-12"><a href="#cb29-12"></a>    <span class="at">.default =</span> <span class="cn">NA</span></span>
<span id="cb29-13"><a href="#cb29-13"></a>  ))</span>
<span id="cb29-14"><a href="#cb29-14"></a></span>
<span id="cb29-15"><a href="#cb29-15"></a>distinct_values_v2 <span class="ot">&lt;-</span> hp_ipip_final_v2 <span class="sc">%&gt;%</span> </span>
<span id="cb29-16"><a href="#cb29-16"></a>  <span class="fu">distinct</span>(IPIP_response, FW_RV, IPIP_values_corrected) <span class="sc">%&gt;%</span> </span>
<span id="cb29-17"><a href="#cb29-17"></a>  <span class="fu">arrange</span>(FW_RV, <span class="fu">desc</span>(IPIP_values_corrected))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section><section id="step-5" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="step-5">Step 5</h4>
<p>According to the paper, the IPIP scores are getting summed up for each of the dimensions. And we need to do this per participant.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>summary_IPIP <span class="ot">&lt;-</span> hp_ipip_final <span class="sc">%&gt;%</span> </span>
<span id="cb30-2"><a href="#cb30-2"></a>  <span class="fu">group_by</span>(PP_ID, Dimension) <span class="sc">%&gt;%</span> </span>
<span id="cb30-3"><a href="#cb30-3"></a>  <span class="fu">summarise</span>(<span class="at">IPIP_score =</span> <span class="fu">sum</span>(IPIP_values_corrected)) <span class="sc">%&gt;%</span> </span>
<span id="cb30-4"><a href="#cb30-4"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'PP_ID'. You can override using the
`.groups` argument.</code></pre>
</div>
</div>
</section></section><section id="sd3" class="level3" data-number="3.5.2"><h3 data-number="3.5.2" class="anchored" data-anchor-id="sd3">
<span class="header-section-number">3.5.2</span> SD3</h3>
<p><strong>Overall goal</strong> for the SD3 questionnaire: We need to calculate an overall Score for the Dark Triad dimensions <strong>Psychopathy</strong> (lack of emotional warmth for others or empathy paired with sensation seeking, risk-taking behaviour, and lack of guilt), <strong>Machiavellianism</strong> (tendency to manipulate others for own gain), and <strong>Narcissism</strong> (exaggerated sense of grandiosity, importance, entitlement, and need to be admired) per participant.</p>
<p><strong>First, check the data (data object and codebook). What is going on here?</strong> SD items are in data type <select class="webex-select"><option value="blank"></option>
<option value="answer">numeric</option>
<option value="x">character</option>
<option value="x">logical</option>
<option value="x">factor</option></select> and there is <select class="webex-select"><option value="blank"></option>
<option value="x">no</option>
<option value="answer">some</option></select> reverse-scoring for the SD items.</p>
<p><strong>So how do we achieve that?</strong> Actually the steps are fairly similar to what we computed for the IPIP, apart from having to recode the values as numbers before being able to reverse-code them:</p>
<ul>
<li>Step 1: select PP_ID and all the questions related to the SD_questionnaires</li>
<li>Step 2: pivot into long format</li>
<li>Step 3: join with <code>codebook_reduced</code>
</li>
<li>Step 4: reverse_code the scores</li>
<li>Step 5: calculate sums for each dimension</li>
</ul>
<p>Keep to the separate steps if this is more organised for you easier to keep track, but we are attempting this in a single pipe. Keep the solution hidden if you want to challenge yourself.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Data Wrangling code for SD3
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>summary_SD <span class="ot">&lt;-</span> hp_data <span class="sc">%&gt;%</span> </span>
<span id="cb32-2"><a href="#cb32-2"></a>  <span class="fu">select</span>(PP_ID, <span class="fu">starts_with</span>(<span class="st">"SD"</span>)) <span class="sc">%&gt;%</span> <span class="co"># starts_with selects all column names that start with "SD"</span></span>
<span id="cb32-3"><a href="#cb32-3"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>PP_ID, <span class="co"># all columns apart from PP_ID</span></span>
<span id="cb32-4"><a href="#cb32-4"></a>               <span class="at">names_to =</span> <span class="st">"Questionnaire_Item"</span>, <span class="co"># smarter approach</span></span>
<span id="cb32-5"><a href="#cb32-5"></a>               <span class="at">values_to =</span> <span class="st">"SD_response"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb32-6"><a href="#cb32-6"></a>  <span class="fu">left_join</span>(codebook_reduced) <span class="sc">%&gt;%</span> <span class="co"># now that the column names match across questionnaires, we don't need the by argument</span></span>
<span id="cb32-7"><a href="#cb32-7"></a>  <span class="fu">mutate</span>(<span class="at">SD_corrected =</span> <span class="fu">case_when</span>(</span>
<span id="cb32-8"><a href="#cb32-8"></a>    FW_RV <span class="sc">==</span> <span class="st">"Reverse"</span> <span class="sc">~</span> <span class="dv">6</span><span class="sc">-</span>SD_response,</span>
<span id="cb32-9"><a href="#cb32-9"></a>    <span class="at">.default =</span> SD_response</span>
<span id="cb32-10"><a href="#cb32-10"></a>    )) <span class="sc">%&gt;%</span> </span>
<span id="cb32-11"><a href="#cb32-11"></a>  <span class="fu">group_by</span>(PP_ID, Dimension) <span class="sc">%&gt;%</span> </span>
<span id="cb32-12"><a href="#cb32-12"></a>  <span class="fu">summarise</span>(<span class="at">SD_score =</span> <span class="fu">sum</span>(SD_corrected)) <span class="sc">%&gt;%</span> </span>
<span id="cb32-13"><a href="#cb32-13"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(Questionnaire_Item)`
`summarise()` has grouped output by 'PP_ID'. You can override using the
`.groups` argument.</code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section id="pvq-rr" class="level3" data-number="3.5.3"><h3 data-number="3.5.3" class="anchored" data-anchor-id="pvq-rr">
<span class="header-section-number">3.5.3</span> PVQ-RR</h3>
<p><strong>Overall goal</strong> for the PVQ-RR questionnaire: We need to calculate an overall score for each of the 12 dimensions per participant.</p>
<p><strong>First, check the data (data object and codebook). What is going on here?</strong> PVQ items are in data type <select class="webex-select"><option value="blank"></option>
<option value="answer">numeric</option>
<option value="x">character</option>
<option value="x">logical</option>
<option value="x">factor</option></select> and there is <select class="webex-select"><option value="blank"></option>
<option value="answer">no</option>
<option value="x">some</option></select> reverse-scoring for the SD items.</p>
<p><strong>So how do we achieve that?</strong> Actually this is more straightforward than data wrangling for the IPIP and the SD. We basically have to:</p>
<ul>
<li>Step 1: select PP_ID and all the questions related to the PVQ_questionnaires</li>
<li>Step 2: pivot into long format</li>
<li>Step 3: join with <code>codebook_reduced</code>
</li>
<li>Step 4: calculate sums for each dimension</li>
</ul>
<p>Similar to SD, we attempt this in a single pipe. Feel free to try first before looking at the solution below.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Data Wrangling code for PVQ-RR
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a>summary_PVQ <span class="ot">&lt;-</span> hp_data <span class="sc">%&gt;%</span> </span>
<span id="cb34-2"><a href="#cb34-2"></a>  <span class="fu">select</span>(PP_ID, <span class="fu">starts_with</span>(<span class="st">"PVQ"</span>)) <span class="sc">%&gt;%</span> <span class="co"># starts_with selects all column names that start with "PVQ"</span></span>
<span id="cb34-3"><a href="#cb34-3"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>PP_ID, <span class="co"># all columns apart from PP_ID</span></span>
<span id="cb34-4"><a href="#cb34-4"></a>               <span class="at">names_to =</span> <span class="st">"Questionnaire_Item"</span>, <span class="co"># smarter approach</span></span>
<span id="cb34-5"><a href="#cb34-5"></a>               <span class="at">values_to =</span> <span class="st">"PVQ_response"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb34-6"><a href="#cb34-6"></a>  <span class="fu">left_join</span>(codebook_reduced) <span class="sc">%&gt;%</span> <span class="co"># now that the column names match across questionnaires, we don't need the by argument</span></span>
<span id="cb34-7"><a href="#cb34-7"></a>  <span class="fu">group_by</span>(PP_ID, Dimension) <span class="sc">%&gt;%</span> </span>
<span id="cb34-8"><a href="#cb34-8"></a>  <span class="fu">summarise</span>(<span class="at">PVQ_score =</span> <span class="fu">mean</span>(PVQ_response)) <span class="sc">%&gt;%</span> </span>
<span id="cb34-9"><a href="#cb34-9"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(Questionnaire_Item)`
`summarise()` has grouped output by 'PP_ID'. You can override using the
`.groups` argument.</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>One thing though: The Dimension column has the name of the PVQ category but also the abbreviation in brackets. We might want to tidy that up now before we start plotting. We can use the <code>separate()</code> function for that.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a>summary_PVQ <span class="ot">&lt;-</span> summary_PVQ <span class="sc">%&gt;%</span> </span>
<span id="cb36-2"><a href="#cb36-2"></a>  <span class="fu">separate</span>(Dimension, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"Dimension"</span>, <span class="cn">NA</span>), <span class="at">sep =</span> <span class="st">" "</span>) <span class="co"># split column at the space character and keep Dimension and drop the second one (which would have been the abbreviation in brackets (XX))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="sec-appropriate-plot" class="level2" data-number="3.6"><h2 data-number="3.6" class="anchored" data-anchor-id="sec-appropriate-plot">
<span class="header-section-number">3.6</span> Which plot is the appropriate plot???</h2>
<p>Alright, let’s get started with data visualisation, now that we have the data in a tidy format. Question is now, which one is the right plot for your data?</p>
<p>Different types of data require different types of plots, so this comes back to how many variables are you aiming to plot and what kind of data type are they.</p>
<section id="one-categorical-variable" class="level3" data-number="3.6.1"><h3 data-number="3.6.1" class="anchored" data-anchor-id="one-categorical-variable">
<span class="header-section-number">3.6.1</span> One categorical variable</h3>
<section id="barchart-geom_bar" class="level4" data-number="3.6.1.1"><h4 data-number="3.6.1.1" class="anchored" data-anchor-id="barchart-geom_bar">
<span class="header-section-number">3.6.1.1</span> Barchart (<code>geom_bar()</code>)</h4>
<p>Let’s say we want to count some demographics. To keep it simple, we want to show gender counts. We would use a <strong>barplot</strong> for it. This is done with <code>geom_bar()</code> in your third layer, and because the counting is done in the background, the <code>aes</code> only requires an x value (i.e.&nbsp;the name of your variable).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="fu">ggplot</span>(hp_data, <span class="fu">aes</span>(<span class="at">x =</span> gender)) <span class="sc">+</span></span>
<span id="cb37-2"><a href="#cb37-2"></a>  <span class="fu">geom_bar</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-bc-base" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="03-dataviz_files/figure-html/fig-bc-base-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;3.1: Default barchart</figcaption></figure>
</div>
</div>
</div>
<p>This is the base plot done. You can customise it again by adding different layers. Some examples are in the tabs below.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="layers">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Colour</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Axes labels &amp; margins</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">Legend</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" role="tab" aria-controls="tabset-2-4" aria-selected="false">Themes</a></li>
</ul>
<div class="tab-content" data-group="layers">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p>We can change the colour by adding a fill argument in the <code>aes()</code>. If we want to modify these colours further, we would add a <code>scale_fill_?</code> argument. If you have specific colours in mind, you would use <code>scale_fill_manual()</code> or if you want to stick with pre-dined ones, like viridis, use <code>scale_fill_viridis_d()</code></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="fu">ggplot</span>(hp_data, <span class="fu">aes</span>(<span class="at">x =</span> gender, <span class="at">fill =</span> gender)) <span class="sc">+</span></span>
<span id="cb38-2"><a href="#cb38-2"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb38-3"><a href="#cb38-3"></a>  <span class="co"># customise colour</span></span>
<span id="cb38-4"><a href="#cb38-4"></a>  <span class="fu">scale_fill_viridis_d</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="03-dataviz_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p>Nothing too “off” in this case, but given Female and Male are capitalised, we may want to tidy the axes labels a bit. There is also this gap between bottom of the chart and the bars which seems a bit weird. We can remove that with an <code>expansion()</code> function.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="fu">ggplot</span>(hp_data, <span class="fu">aes</span>(<span class="at">x =</span> gender, <span class="at">fill =</span> gender)) <span class="sc">+</span></span>
<span id="cb39-2"><a href="#cb39-2"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb39-3"><a href="#cb39-3"></a>  <span class="fu">scale_fill_viridis_d</span>() <span class="sc">+</span></span>
<span id="cb39-4"><a href="#cb39-4"></a>  <span class="co"># changing labels v1 (with labs function, can add x and y)</span></span>
<span id="cb39-5"><a href="#cb39-5"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Gender"</span>) <span class="sc">+</span> </span>
<span id="cb39-6"><a href="#cb39-6"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb39-7"><a href="#cb39-7"></a>    <span class="co"># changing labels v2 (within the scale function, only deals with either x or y depending if it's scale_x or scale_y)</span></span>
<span id="cb39-8"><a href="#cb39-8"></a>    <span class="at">name =</span> <span class="st">"Count"</span>,</span>
<span id="cb39-9"><a href="#cb39-9"></a>    <span class="co"># remove the space below the bars (first number), but keep a tiny bit (5%) above (second number)</span></span>
<span id="cb39-10"><a href="#cb39-10"></a>    <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>))</span>
<span id="cb39-11"><a href="#cb39-11"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="03-dataviz_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<p>The legend does not add any information because the labels are already provided on the x axis. We can remove the legend by adding the argument <code>guide = "none"</code> into the <code>scale_fill</code> function.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="fu">ggplot</span>(hp_data, <span class="fu">aes</span>(<span class="at">x =</span> gender, <span class="at">fill =</span> gender)) <span class="sc">+</span></span>
<span id="cb40-2"><a href="#cb40-2"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb40-3"><a href="#cb40-3"></a>  <span class="fu">scale_fill_viridis_d</span>(</span>
<span id="cb40-4"><a href="#cb40-4"></a>    <span class="co"># remove the legend</span></span>
<span id="cb40-5"><a href="#cb40-5"></a>    <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb40-6"><a href="#cb40-6"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Gender"</span>) <span class="sc">+</span> </span>
<span id="cb40-7"><a href="#cb40-7"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb40-8"><a href="#cb40-8"></a>    <span class="at">name =</span> <span class="st">"Count"</span>,</span>
<span id="cb40-9"><a href="#cb40-9"></a>    <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>))</span>
<span id="cb40-10"><a href="#cb40-10"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="03-dataviz_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-4-tab">
<p>Let’s experiment with the themes. For this plot we have chosen <code>theme_minimal()</code></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="fu">ggplot</span>(hp_data, <span class="fu">aes</span>(<span class="at">x =</span> gender, <span class="at">fill =</span> gender)) <span class="sc">+</span></span>
<span id="cb41-2"><a href="#cb41-2"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb41-3"><a href="#cb41-3"></a>  <span class="fu">scale_fill_viridis_d</span>(</span>
<span id="cb41-4"><a href="#cb41-4"></a>    <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb41-5"><a href="#cb41-5"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Gender"</span>) <span class="sc">+</span> </span>
<span id="cb41-6"><a href="#cb41-6"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb41-7"><a href="#cb41-7"></a>    <span class="at">name =</span> <span class="st">"Count"</span>,</span>
<span id="cb41-8"><a href="#cb41-8"></a>    <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>))</span>
<span id="cb41-9"><a href="#cb41-9"></a>  ) <span class="sc">+</span></span>
<span id="cb41-10"><a href="#cb41-10"></a>  <span class="co"># pick a theme</span></span>
<span id="cb41-11"><a href="#cb41-11"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="03-dataviz_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section id="column-plot-geom_col" class="level4" data-number="3.6.1.2"><h4 data-number="3.6.1.2" class="anchored" data-anchor-id="column-plot-geom_col">
<span class="header-section-number">3.6.1.2</span> Column plot (<code>geom_col()</code>)</h4>
<p>If someone had already summarised those counts for you, you would not be able to use <code>geom_bar()</code>. In that case, you would switch to <code>geom_col()</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a>gender_count <span class="ot">&lt;-</span> hp_data <span class="sc">%&gt;%</span> </span>
<span id="cb42-2"><a href="#cb42-2"></a>  <span class="fu">count</span>(gender)</span>
<span id="cb42-3"><a href="#cb42-3"></a></span>
<span id="cb42-4"><a href="#cb42-4"></a>gender_count</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">gender</th>
<th style="text-align: right;">n</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Female</td>
<td style="text-align: right;">819</td>
</tr>
<tr class="even">
<td style="text-align: left;">Male</td>
<td style="text-align: right;">169</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>The mapping for <code>geom_col()</code> requires both an <strong>x</strong> and a <strong>y</strong> aesthetics. In our example, x would be our categorical variable (e.g., <code>gender</code>), and y would be the column name that stored the values (<code>n</code>). Note how the base version has now n as an axis title (instead of count).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="fu">ggplot</span>(gender_count, <span class="fu">aes</span>(<span class="at">x =</span> gender, <span class="at">y =</span> n, <span class="at">fill =</span> gender)) <span class="sc">+</span></span>
<span id="cb43-2"><a href="#cb43-2"></a>  <span class="fu">geom_col</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-col" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="03-dataviz_files/figure-html/fig-col-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;3.2: Column plot with different coloured bars</figcaption></figure>
</div>
</div>
</div>
</section></section><section id="activity-5-make-the-column-plot-pretty" class="level3 unnumbered"><h3 class="unnumbered anchored" data-anchor-id="activity-5-make-the-column-plot-pretty">Activity 5: Make the column plot pretty</h3>
<p>The other layers to change the colour scheme, axes labels and margins, removing the legend and altering the theme require exactly the same functions as with the boxplot above. Test yourself to see if you could…</p>
<ul class="task-list">
<li>
<input type="checkbox">change the colour scheme (e.g., viridis or <a href="https://www.datanovia.com/en/blog/the-a-z-of-rcolorbrewer-palette/" target="_blank">any other colour palettes</a>)</li>
<li>
<input type="checkbox">remove the legend</li>
<li>
<input type="checkbox">change the title of the x and y axes</li>
<li>
<input type="checkbox">make the bars start directly on the x axis</li>
<li>
<input type="checkbox">add a theme of your linking</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Possible solution code for the column plot (with a different colour palette and a different theme)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="fu">ggplot</span>(gender_count, <span class="fu">aes</span>(<span class="at">x =</span> gender, <span class="at">y =</span> n, <span class="at">fill =</span> gender)) <span class="sc">+</span></span>
<span id="cb44-2"><a href="#cb44-2"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb44-3"><a href="#cb44-3"></a>  <span class="co"># replaced vidiris with the brewer palette</span></span>
<span id="cb44-4"><a href="#cb44-4"></a>  <span class="fu">scale_fill_brewer</span>(</span>
<span id="cb44-5"><a href="#cb44-5"></a>    <span class="at">palette =</span> <span class="st">"Set1"</span>, <span class="co"># try "Set2" or "Dark2" for some variety</span></span>
<span id="cb44-6"><a href="#cb44-6"></a>    <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span> <span class="co"># legend removed</span></span>
<span id="cb44-7"><a href="#cb44-7"></a>  <span class="co"># changing both x and y in labs</span></span>
<span id="cb44-8"><a href="#cb44-8"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Gender"</span>, <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span> </span>
<span id="cb44-9"><a href="#cb44-9"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb44-10"><a href="#cb44-10"></a>    <span class="co"># starts bars on x axis without any gaps but leaves some space at the top (this time 10%)</span></span>
<span id="cb44-11"><a href="#cb44-11"></a>    <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>)) </span>
<span id="cb44-12"><a href="#cb44-12"></a>  ) <span class="sc">+</span></span>
<span id="cb44-13"><a href="#cb44-13"></a>  <span class="co"># different theme</span></span>
<span id="cb44-14"><a href="#cb44-14"></a>  <span class="fu">theme_light</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="03-dataviz_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section id="two-categorical-variables" class="level3" data-number="3.6.2"><h3 data-number="3.6.2" class="anchored" data-anchor-id="two-categorical-variables">
<span class="header-section-number">3.6.2</span> Two categorical variables</h3>
<p>Lets have a look at the relationship between the houses participants being sorted into vs the house they wished they had been allocated to.</p>
<p>Pre-step: First, we’d need to wrangle the data a bit before we start building plots. When we look at the data, we see that a few people are actually managed to be sorted into more than one house. How is this even possible??? We only want those participants who only selected one house. Fortunately, all participants responded with one “wish” category, so nothing to fix there.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a>hp_houses <span class="ot">&lt;-</span> hp_data <span class="sc">%&gt;%</span> </span>
<span id="cb45-2"><a href="#cb45-2"></a>  <span class="fu">select</span>(PP_ID, Sorting_house, Sorting_house_wish) <span class="sc">%&gt;%</span> </span>
<span id="cb45-3"><a href="#cb45-3"></a>  <span class="fu">filter</span>(Sorting_house <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Gryffindor"</span>, <span class="st">"Hufflepuff"</span>, <span class="st">"Ravenclaw"</span>, <span class="st">"Slytherin"</span>))</span>
<span id="cb45-4"><a href="#cb45-4"></a></span>
<span id="cb45-5"><a href="#cb45-5"></a><span class="fu">head</span>(hp_houses)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: right;">PP_ID</th>
<th style="text-align: left;">Sorting_house</th>
<th style="text-align: left;">Sorting_house_wish</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: left;">Ravenclaw</td>
<td style="text-align: left;">Ravenclaw</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: left;">Gryffindor</td>
<td style="text-align: left;">Ravenclaw</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: left;">Gryffindor</td>
<td style="text-align: left;">Ravenclaw</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: left;">Slytherin</td>
<td style="text-align: left;">Slytherin</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: left;">Slytherin</td>
<td style="text-align: left;">Hufflepuff</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: left;">Ravenclaw</td>
<td style="text-align: left;">Ravenclaw</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>One way to display that data is by creating a <strong>Stacked barchart</strong> (default option) or a <strong>Percent stacked barchart</strong>. For both options, the subgroups are displayed on top of each other. To show the two plots next to each other for better comparison, we moved the legend to the bottom of the chart and displayed the content across 2 rows.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="do">## Stacked barchart</span></span>
<span id="cb46-2"><a href="#cb46-2"></a><span class="fu">ggplot</span>(hp_houses, <span class="fu">aes</span>(<span class="at">x =</span> Sorting_house, <span class="at">fill =</span> Sorting_house_wish)) <span class="sc">+</span></span>
<span id="cb46-3"><a href="#cb46-3"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span> <span class="co"># no position argument added</span></span>
<span id="cb46-4"><a href="#cb46-4"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span> <span class="co"># move legend to the bottom</span></span>
<span id="cb46-5"><a href="#cb46-5"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">2</span>)) <span class="co"># display across 2 rows</span></span>
<span id="cb46-6"><a href="#cb46-6"></a></span>
<span id="cb46-7"><a href="#cb46-7"></a><span class="do">## Percent stacked barchart</span></span>
<span id="cb46-8"><a href="#cb46-8"></a><span class="fu">ggplot</span>(hp_houses, <span class="fu">aes</span>(<span class="at">x =</span> Sorting_house, <span class="at">fill =</span> Sorting_house_wish)) <span class="sc">+</span></span>
<span id="cb46-9"><a href="#cb46-9"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span> <span class="co"># add position argument here</span></span>
<span id="cb46-10"><a href="#cb46-10"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span> <span class="co"># move legend to the bottom</span></span>
<span id="cb46-11"><a href="#cb46-11"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">2</span>)) <span class="co"># display across 2 rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-barcharts_stacked" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="03-dataviz_files/figure-html/fig-barcharts_stacked-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;3.3: Stacked barchart (left), and Percent stacked barchart (right)</figcaption></figure>
</div>
</div>
</div>
<p>In the <strong>stacked barchart</strong> (<a href="#fig-barcharts_stacked">Figure&nbsp;<span>3.3</span></a>, left plot), you are able to plot participant numbers. Here we can see that <code>hp_houses</code> has a lot more participants who were sorted into Ravenclaw but also who wanted to be in Ravenclaw. We can also see that most participants were sorted into the houses they wished to be in, and that the lowest number of participants were sorted into Slytherin. However, we are having a tough time to see whether the ratio is the same across all 4 houses.</p>
<p>If we wanted to show that, a <strong>Percent stacked barchart</strong> (<a href="#fig-barcharts_stacked">Figure&nbsp;<span>3.3</span></a>, right plot) would make a lot more sense. Now we would be able to observe that a higher proportion of Ravenclaw-hopefuls actually ended up in Ravenclaw compared to Gryffindor-hopefuls, Hufflepuff-hopefuls, and Slytherin-hopefuls getting sorted into Gryffindor, Hufflepuff, and Slytherin respectively. BUT! We would lose the information about the raw values in the sample.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The position argument <code>position = "stack"</code> is the default. Adding this argument to the code for the left plot in <a href="#fig-barcharts_stacked">Figure&nbsp;<span>3.3</span></a> would produce the same plot a leaving the argument out.</p>
</div>
</div>
<p>A second option is a <strong>Grouped barchart</strong> which displays the bars next to each other. We would achieve that by changing the position argument to <strong>“dogde”</strong>. You can see the default version of the plot in the <a href="#fig-barchart_grouped">Figure&nbsp;<span>3.4</span></a> on the left, and one with more layers on the right.</p>
<p>Jakob et al.&nbsp;(2019) used the following HEX colours for their plots:</p>
<ul>
<li>Gryffindor #7F0909</li>
<li>Hufflepuff #f0c75e</li>
<li>Ravenclaw #08245e</li>
<li>Slytherin #2a623d</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="do">## Default grouped barchart</span></span>
<span id="cb47-2"><a href="#cb47-2"></a><span class="fu">ggplot</span>(hp_houses, <span class="fu">aes</span>(<span class="at">x =</span> Sorting_house, <span class="at">fill =</span> Sorting_house_wish)) <span class="sc">+</span></span>
<span id="cb47-3"><a href="#cb47-3"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span> <span class="co"># add position argument here</span></span>
<span id="cb47-4"><a href="#cb47-4"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span> <span class="co"># move legend to the bottom</span></span>
<span id="cb47-5"><a href="#cb47-5"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">2</span>)) <span class="co"># display across 2 rows</span></span>
<span id="cb47-6"><a href="#cb47-6"></a></span>
<span id="cb47-7"><a href="#cb47-7"></a><span class="do">## Prettier grouped barchart</span></span>
<span id="cb47-8"><a href="#cb47-8"></a><span class="fu">ggplot</span>(hp_houses, <span class="fu">aes</span>(<span class="at">x =</span> Sorting_house, <span class="at">fill =</span> Sorting_house_wish)) <span class="sc">+</span></span>
<span id="cb47-9"><a href="#cb47-9"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span> <span class="co"># add position argument here</span></span>
<span id="cb47-10"><a href="#cb47-10"></a>  <span class="co"># changing colours to Harry Potter House colours</span></span>
<span id="cb47-11"><a href="#cb47-11"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">'#7F0909'</span>, <span class="st">'#f0c75e'</span>, <span class="st">'#08245e'</span>, <span class="st">'#2a623d'</span>)) <span class="sc">+</span></span>
<span id="cb47-12"><a href="#cb47-12"></a>  <span class="co"># changing labels for x, y, and fill</span></span>
<span id="cb47-13"><a href="#cb47-13"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"House sorted into"</span>, <span class="at">y =</span> <span class="st">"Count"</span>, <span class="at">fill =</span> <span class="st">"House wished for"</span>) <span class="sc">+</span> </span>
<span id="cb47-14"><a href="#cb47-14"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb47-15"><a href="#cb47-15"></a>    <span class="co"># remove the space below the bars, but keep a tiny bit (5%) above</span></span>
<span id="cb47-16"><a href="#cb47-16"></a>    <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>))</span>
<span id="cb47-17"><a href="#cb47-17"></a>  ) <span class="sc">+</span></span>
<span id="cb47-18"><a href="#cb47-18"></a>  <span class="co"># pick a theme</span></span>
<span id="cb47-19"><a href="#cb47-19"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb47-20"><a href="#cb47-20"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span> <span class="co"># need to move this part to the end otherwise the `theme_*` overrides it</span></span>
<span id="cb47-21"><a href="#cb47-21"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">2</span>)) <span class="co"># display across 2 rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-barchart_grouped" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="03-dataviz_files/figure-html/fig-barchart_grouped-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;3.4: Default grouped barchart (left) and one with a few more layers added (right)</figcaption></figure>
</div>
</div>
</div>
<p>One more thing we could have done is using <code>facet_wrap()</code> to split the different houses into their own subplots. Now we can compare better in which house participants were sorted into according to wish-houses categories. For example, people who have hoped for Gryffindor, were most likely sorted into Gryffindor, followed by Hufflepuff, Ravenclaw, and Slytherin. Slytherin-hopefuls were most likely to end up in Slytherin, followed by Ravenclaw, Gryffindor, and Hufflepuff.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="fu">ggplot</span>(hp_houses, <span class="fu">aes</span>(<span class="at">x =</span> Sorting_house, <span class="at">fill =</span> Sorting_house_wish)) <span class="sc">+</span></span>
<span id="cb48-2"><a href="#cb48-2"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span> </span>
<span id="cb48-3"><a href="#cb48-3"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">'#7F0909'</span>, <span class="st">'#f0c75e'</span>, <span class="st">'#08245e'</span>, <span class="st">'#2a623d'</span>)) <span class="sc">+</span></span>
<span id="cb48-4"><a href="#cb48-4"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"House sorted into"</span>, <span class="at">y =</span> <span class="st">"Count"</span>, <span class="at">fill =</span> <span class="st">"House wished for"</span>) <span class="sc">+</span> </span>
<span id="cb48-5"><a href="#cb48-5"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb48-6"><a href="#cb48-6"></a>    <span class="co"># remove the space below the bars, but keep a tiny bit (5%) above</span></span>
<span id="cb48-7"><a href="#cb48-7"></a>    <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>))</span>
<span id="cb48-8"><a href="#cb48-8"></a>  ) <span class="sc">+</span></span>
<span id="cb48-9"><a href="#cb48-9"></a>  <span class="co"># pick a theme</span></span>
<span id="cb48-10"><a href="#cb48-10"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb48-11"><a href="#cb48-11"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span> <span class="co"># need to move this part to the end otherwise the `theme_*` overrides it</span></span>
<span id="cb48-12"><a href="#cb48-12"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Sorting_house_wish)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="03-dataviz_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section><section id="one-continuous-variable" class="level3" data-number="3.6.3"><h3 data-number="3.6.3" class="anchored" data-anchor-id="one-continuous-variable">
<span class="header-section-number">3.6.3</span> One continuous variable</h3>
<section id="histogram-geom_histogram" class="level4" data-number="3.6.3.1"><h4 data-number="3.6.3.1" class="anchored" data-anchor-id="histogram-geom_histogram">
<span class="header-section-number">3.6.3.1</span> Histogram <code>geom_histogram()</code>
</h4>
<p>If you wanted to show the distribution of a continuous variable, you can use a histogram. As with every plot, you need at least 3 layers to create a base version of the plot. Similar to <code>geom_bar()</code>, <code>geom_histogram()</code> only requires an <code>x</code> variable.</p>
<p>A histogram splits the data into “bins” (i.e., groupings displayed in a single bar). These values are plotted along the x-axis and shows the count of how many observations are in each bin along the y-axis. It’s basically a bar chart for continuous variables.</p>
<p>Let’s have a look at the age distribution in our dataset.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing non-finite outside the scale range
(`stat_bin()`).</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-hist" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="03-dataviz_files/figure-html/fig-hist-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;3.5: Default histogram</figcaption></figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
warning message
</div>
</div>
<div class="callout-body-container callout-body">
<p>The warning message tell us that 2 rows were removed because they contained non-finite values outside the scale range. If you have a closer look at the data, you can spot those 2 rows as missing values.</p>
</div>
</div>
<p>The default <strong>bin number</strong> is 30 (as displayed in <a href="#fig-hist">Figure&nbsp;<span>3.5</span></a> above). Changing the number of bins (argument <code>bins</code>) can help to show more or less fine tuning in the data. Bigger numbers of bins means more finetuning.</p>
<p>Perhaps it’s more intuitive to modify the <strong>width of each bin</strong> instead via the argument (<code>binwidth</code>). So for example <code>binwidth = 1</code> for category age would mean 1 year of age per “age group”; <code>binwidth = 5</code> would mean 5 years of age span per “age group”, etc. The plots below show modifications for both <code>bin</code> and <code>binwidth</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a><span class="co">#less finetuning</span></span>
<span id="cb51-2"><a href="#cb51-2"></a><span class="fu">ggplot</span>(hp_data, <span class="fu">aes</span>(<span class="at">x =</span> age)) <span class="sc">+</span></span>
<span id="cb51-3"><a href="#cb51-3"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">10</span>) </span>
<span id="cb51-4"><a href="#cb51-4"></a></span>
<span id="cb51-5"><a href="#cb51-5"></a><span class="co"># more fineturning</span></span>
<span id="cb51-6"><a href="#cb51-6"></a><span class="fu">ggplot</span>(hp_data, <span class="fu">aes</span>(<span class="at">x =</span> age)) <span class="sc">+</span></span>
<span id="cb51-7"><a href="#cb51-7"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing non-finite outside the scale range (`stat_bin()`).
Removed 2 rows containing non-finite outside the scale range (`stat_bin()`).</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-bins" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="03-dataviz_files/figure-html/fig-bins-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;3.6: Bins vs binwidth arguments</figcaption></figure>
</div>
</div>
</div>
<p>The <strong>warning message</strong> telling us 2 row of data were removed due to containing <code>non-finite values outside the scale range</code>. Have a look at the age column in <code>hp_data</code> to see if you can decipher the warning message.</p>
<p>They were removed because <select class="webex-select"><option value="blank"></option>
<option value="x">they fall outside of the plot range</option>
<option value="answer">they contain missing values</option></select>.</p>
<p>Colours are getting manipulated slightly differently to the barchart. Click through each tab to see how you can alter colour, axes labels, margins and breaks, and add a different theme.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="layers">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Colour</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Axes labels, margins, and breaks</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">Themes</a></li>
</ul>
<div class="tab-content" data-group="layers">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<p>We can change the plot colours by adding a <strong>fill argument</strong> and a <strong>colour argument</strong>. The <code>fill</code> argument manipulates the colour of the bars, and the <code>colour</code> argument changes the outline of the bars. Pay attention that they are <strong>added directly to the <code>geom_histogram</code> arguments</strong>, not the overall <code>aes()</code> like we did with the boxplot.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a><span class="fu">ggplot</span>(hp_data, <span class="fu">aes</span>(<span class="at">x =</span> age)) <span class="sc">+</span></span>
<span id="cb53-2"><a href="#cb53-2"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">fill =</span> <span class="st">"#586cfd"</span>, <span class="at">colour =</span> <span class="st">"#FC58BE"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="03-dataviz_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>You could use hex codes for fill and color, like we used here, <code>geom_histogram(binwidth = 1, fill = "#586cfd", colour = "#FC58BE")</code>. If you want create your own colours, check out <a href="https://www.hexcolortool.com/" target="_blank">this website</a>.</p>
<p>or</p>
<p>You could use a pre-defined colour name <code>geom_histogram(binwidth = 1, fill = "purple", colour = "green")</code>. See a full list <a href="https://www.datanovia.com/en/blog/awesome-list-of-657-r-color-names/" target="_blank">here</a></p>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<p>Here we <strong>removed the label</strong> for the y axes (to show you some variety) and <strong>modified the breaks</strong>. The y axis is now displayed in increasing steps of 10 (rather than 30), and the x axis has 5-year increments rather than 10. The <code>expansion()</code> function works the same to the version we already encountered removing the gap between x axis and bars.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a><span class="fu">ggplot</span>(hp_data, <span class="fu">aes</span>(<span class="at">x =</span> age)) <span class="sc">+</span></span>
<span id="cb54-2"><a href="#cb54-2"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">fill =</span> <span class="st">"#586cfd"</span>, <span class="at">colour =</span> <span class="st">"#FC58BE"</span>) <span class="sc">+</span></span>
<span id="cb54-3"><a href="#cb54-3"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Age (in years)"</span>, <span class="co"># renaming x axis label</span></span>
<span id="cb54-4"><a href="#cb54-4"></a>       <span class="at">y =</span> <span class="st">""</span>) <span class="sc">+</span> <span class="co"># removing the y axis label</span></span>
<span id="cb54-5"><a href="#cb54-5"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb54-6"><a href="#cb54-6"></a>    <span class="co"># remove the space below the bars (first number), but keep a tiny bit (5%) above (second number)</span></span>
<span id="cb54-7"><a href="#cb54-7"></a>    <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>)),</span>
<span id="cb54-8"><a href="#cb54-8"></a>    <span class="co"># changing break points on y axis</span></span>
<span id="cb54-9"><a href="#cb54-9"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">120</span>, <span class="at">by =</span> <span class="dv">10</span>),</span>
<span id="cb54-10"><a href="#cb54-10"></a>  ) <span class="sc">+</span></span>
<span id="cb54-11"><a href="#cb54-11"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb54-12"><a href="#cb54-12"></a>    <span class="co"># changing break points on x axis</span></span>
<span id="cb54-13"><a href="#cb54-13"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">10</span>, <span class="at">to =</span> <span class="dv">70</span>, <span class="at">by =</span> <span class="dv">5</span>),</span>
<span id="cb54-14"><a href="#cb54-14"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="03-dataviz_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<p>Let’s experiment with the themes. For this plot we have chosen <code>theme_bw()</code></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a><span class="fu">ggplot</span>(hp_data, <span class="fu">aes</span>(<span class="at">x =</span> age)) <span class="sc">+</span></span>
<span id="cb55-2"><a href="#cb55-2"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">fill =</span> <span class="st">"#586cfd"</span>, <span class="at">colour =</span> <span class="st">"#FC58BE"</span>) <span class="sc">+</span></span>
<span id="cb55-3"><a href="#cb55-3"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Age (in years)"</span>,</span>
<span id="cb55-4"><a href="#cb55-4"></a>       <span class="at">y =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb55-5"><a href="#cb55-5"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb55-6"><a href="#cb55-6"></a>    <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>)),</span>
<span id="cb55-7"><a href="#cb55-7"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">120</span>, <span class="at">by =</span> <span class="dv">10</span>),</span>
<span id="cb55-8"><a href="#cb55-8"></a>  ) <span class="sc">+</span></span>
<span id="cb55-9"><a href="#cb55-9"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb55-10"><a href="#cb55-10"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">10</span>, <span class="at">to =</span> <span class="dv">70</span>, <span class="at">by =</span> <span class="dv">5</span>),</span>
<span id="cb55-11"><a href="#cb55-11"></a>  ) <span class="sc">+</span></span>
<span id="cb55-12"><a href="#cb55-12"></a>  <span class="co"># pick a theme</span></span>
<span id="cb55-13"><a href="#cb55-13"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="03-dataviz_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section></section><section id="one-continuous-and-one-categorical-grouping-variable" class="level3" data-number="3.6.4"><h3 data-number="3.6.4" class="anchored" data-anchor-id="one-continuous-and-one-categorical-grouping-variable">
<span class="header-section-number">3.6.4</span> One continuous and one categorical grouping variable</h3>
<section id="boxplot" class="level4" data-number="3.6.4.1"><h4 data-number="3.6.4.1" class="anchored" data-anchor-id="boxplot">
<span class="header-section-number">3.6.4.1</span> Boxplot</h4>
</section></section><section id="activity-6-recreating-a-boxplot-from-jakob-et-al.-2019" class="level3 unnumbered"><h3 class="unnumbered anchored" data-anchor-id="activity-6-recreating-a-boxplot-from-jakob-et-al.-2019">Activity 6: Recreating a boxplot from Jakob et al.&nbsp;(2019)</h3>
<p>Let’s try something different for the boxplot. Figure 1 in the paper shows a boxplot for the Personality traits across Houses. See below:</p>
<p><img src="images/Jakob_boxplot.PNG" class="img-fluid"></p>
<p>Let’s see if we can actually re-create this plot.</p>
<section id="step-1-create-a-default-boxplot" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="step-1-create-a-default-boxplot">Step 1: create a default boxplot</h4>
<p><code>Personality Traits</code> is on the x axis and some sort of <code>average Score</code> is in the y axis. But hang on, They combined the Big 5 personality traits and the ones from the Dark Triads questionnaire. Hmmm. Our data doesn’t look like that yet. Our values are scattered across 3 different dataframes. The personality data we need are in <code>summary_IPIP</code> the Dark Triad data are in <code>summary_SD</code>, and the information about which house the participants got sorted into is in <code>hp_data</code>.</p>
<section id="pre-steps" class="level5 unnumbered"><h5 class="unnumbered anchored" data-anchor-id="pre-steps">Pre-Steps</h5>
<p>Try to wrangle the data according to the steps below before looking at the solution.</p>
<ol type="1">
<li>We need information of the participant and which house they were sorted into. Think about where we would find the information and how to isolate it. Tidy that data up. Remember, there were participants who were sorted into more than one house, and we need to filter them out again.</li>
<li>combine the data from <code>summary_IPIP</code> and <code>summary_SD</code>. Think about what join to use to keep information from both dataframes. After this step, we should have 3 columns and 8 scores per participant. (hint: pay attention to the Score column names in both dataframes - this can be addressed in a variety of ways)</li>
<li>We need to merge the output from 2. with the demographics we extracted in step 1.</li>
<li>We also need to change one of the column names to “Score” if you have not addressed this in a previous step</li>
<li>Drop missing values</li>
</ol>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution to the data wrangling steps
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-12-contents" aria-controls="callout-12" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Are you sure you want to reveal the solution?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-12" class="callout-12-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a><span class="co"># 1. select PP_ID and selected_house from hp_data</span></span>
<span id="cb56-2"><a href="#cb56-2"></a>demog <span class="ot">&lt;-</span> hp_data <span class="sc">%&gt;%</span> </span>
<span id="cb56-3"><a href="#cb56-3"></a>  <span class="fu">select</span>(PP_ID, Sorting_house) <span class="sc">%&gt;%</span> </span>
<span id="cb56-4"><a href="#cb56-4"></a>  <span class="co"># use filter to focus on the people who selected 1 house only</span></span>
<span id="cb56-5"><a href="#cb56-5"></a>  <span class="fu">filter</span>(Sorting_house <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Gryffindor"</span>, <span class="st">"Hufflepuff"</span>, <span class="st">"Ravenclaw"</span>, <span class="st">"Slytherin"</span>))</span>
<span id="cb56-6"><a href="#cb56-6"></a></span>
<span id="cb56-7"><a href="#cb56-7"></a><span class="co"># 2. combine the data from summary_IPIP and summary_SD</span></span>
<span id="cb56-8"><a href="#cb56-8"></a>personality <span class="ot">&lt;-</span> <span class="fu">full_join</span>(summary_IPIP, summary_SD, <span class="at">by =</span> <span class="fu">join_by</span>(PP_ID, Dimension, IPIP_score <span class="sc">==</span> SD_score)) <span class="sc">%&gt;%</span> </span>
<span id="cb56-9"><a href="#cb56-9"></a>  </span>
<span id="cb56-10"><a href="#cb56-10"></a><span class="co"># 3. merge personality with demog</span></span>
<span id="cb56-11"><a href="#cb56-11"></a>  <span class="fu">full_join</span>(demog) <span class="sc">%&gt;%</span> </span>
<span id="cb56-12"><a href="#cb56-12"></a></span>
<span id="cb56-13"><a href="#cb56-13"></a><span class="co"># 4. change column name to Score</span></span>
<span id="cb56-14"><a href="#cb56-14"></a>  <span class="fu">rename</span>(<span class="at">Score =</span> IPIP_score) <span class="sc">%&gt;%</span> </span>
<span id="cb56-15"><a href="#cb56-15"></a></span>
<span id="cb56-16"><a href="#cb56-16"></a><span class="co"># 5. drop NA</span></span>
<span id="cb56-17"><a href="#cb56-17"></a>  <span class="fu">drop_na</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(PP_ID)`</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Now we can start out default boxplot</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> personality, <span class="fu">aes</span>(<span class="at">x =</span> Dimension, <span class="at">y =</span> Score, <span class="at">fill =</span> Sorting_house)) <span class="sc">+</span></span>
<span id="cb58-2"><a href="#cb58-2"></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="03-dataviz_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="step-2-change-the-colours" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="step-2-change-the-colours">Step 2: change the colours</h4>
<p>We are still using the Hex colours defined by the Jakob et al.&nbsp;(2019).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> personality, <span class="fu">aes</span>(<span class="at">x =</span> Dimension, <span class="at">y =</span> Score, <span class="at">fill =</span> Sorting_house)) <span class="sc">+</span></span>
<span id="cb59-2"><a href="#cb59-2"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb59-3"><a href="#cb59-3"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">'#7F0909'</span>, <span class="st">'#f0c75e'</span>, <span class="st">'#08245e'</span>, <span class="st">'#2a623d'</span>)) <span class="co"># change colours</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="03-dataviz_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section><section id="step-3-the-colours-look-too-strong-and-legend-is-in-the-wrong-position-and-does-not-want-a-category-label" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="step-3-the-colours-look-too-strong-and-legend-is-in-the-wrong-position-and-does-not-want-a-category-label">Step 3: the colours look too strong, and legend is in the wrong position and does not want a category label</h4>
<ul>
<li>To mute the colours slightly, we can define alpha within the <code>geom_boxplot()</code> making the plot colours more transparent. This took a bit of trial and error, but I think we are good with an alpha value of around .75 (or at least one my screen).</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> personality, <span class="fu">aes</span>(<span class="at">x =</span> Dimension, <span class="at">y =</span> Score, <span class="at">fill =</span> Sorting_house)) <span class="sc">+</span></span>
<span id="cb60-2"><a href="#cb60-2"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span> <span class="co"># add alpha here</span></span>
<span id="cb60-3"><a href="#cb60-3"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">'#7F0909'</span>, <span class="st">'#f0c75e'</span>, <span class="st">'#08245e'</span>, <span class="st">'#2a623d'</span>),</span>
<span id="cb60-4"><a href="#cb60-4"></a>                    <span class="at">name =</span> <span class="st">""</span>) <span class="sc">+</span> <span class="co"># delete the fill variable's title</span></span>
<span id="cb60-5"><a href="#cb60-5"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="03-dataviz_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section><section id="step-4-remove-grey-background-the-x-axis-needs-attention-and-they-have-a-plot-title-included" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="step-4-remove-grey-background-the-x-axis-needs-attention-and-they-have-a-plot-title-included">Step 4: Remove grey background, the x axis needs attention and they have a plot title included</h4>
<p>Looks like <code>theme_classic()</code> to me. Remember we have to add <code>theme_classic()</code> before moving the <code>legend.position</code>, otherwise the legend will be back on the right.</p>
<p>The x axis has the wrong label and we need to replace some of the names as they are too long and the original authors abbreviated them. Relabelling the x axis title should be straightforward by now.</p>
<p>But what about the labels of the categories? Here, we can just add an argument to <code>scale_x_discrete()</code> that relabels the categories. This is all working because they are ordered alphabetically. For orders that you want to have displayed non-alphabetically, you might need to change the character variable into a factor in the data frame and re-order the labels there before plotting <strong><em>[add cross-ref for chapter 2]</em></strong>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> personality, <span class="fu">aes</span>(<span class="at">x =</span> Dimension, <span class="at">y =</span> Score, <span class="at">fill =</span> Sorting_house)) <span class="sc">+</span></span>
<span id="cb61-2"><a href="#cb61-2"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span> <span class="co"># add alpha here</span></span>
<span id="cb61-3"><a href="#cb61-3"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">'#7F0909'</span>, <span class="st">'#f0c75e'</span>, <span class="st">'#08245e'</span>, <span class="st">'#2a623d'</span>),</span>
<span id="cb61-4"><a href="#cb61-4"></a>                    <span class="at">name =</span> <span class="st">""</span>) <span class="sc">+</span> <span class="co"># delete the fill variable's title</span></span>
<span id="cb61-5"><a href="#cb61-5"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">name =</span> <span class="st">"Personality Traits"</span>,</span>
<span id="cb61-6"><a href="#cb61-6"></a>                   <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Agreeabl."</span>, <span class="st">"Conscient."</span>, <span class="st">"EmStability"</span>, <span class="st">"Extraversion"</span>, <span class="st">"Intellect"</span>, <span class="st">"Machiav."</span>, <span class="st">"Narcissism"</span>, <span class="st">"Psychopathy"</span>)) <span class="sc">+</span></span>
<span id="cb61-7"><a href="#cb61-7"></a>  <span class="fu">ggtitle</span>(<span class="st">"Personality Traits across Houses"</span>) <span class="sc">+</span></span>
<span id="cb61-8"><a href="#cb61-8"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="co"># remove grey background</span></span>
<span id="cb61-9"><a href="#cb61-9"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb61-10"><a href="#cb61-10"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="co"># centers the title (took quite a bit of digging how to do that)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-recreated" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="03-dataviz_files/figure-html/fig-recreated-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;3.7: Recreated boxplot</figcaption></figure>
</div>
</div>
</div>
<p>Looks about right.Maybe the outlier points are a bit bigger in the original plot, but I think we can let that slide.</p>
</section><section id="violin-boxplots" class="level4" data-number="3.6.4.2"><h4 data-number="3.6.4.2" class="anchored" data-anchor-id="violin-boxplots">
<span class="header-section-number">3.6.4.2</span> Violin-boxplots</h4>
<p>rewrite: PVQ data by categories and for faceting, merge with demog so we get the information about the houses participants were sorted into. We already created demog in one of the steps above, so we can reuse it straight away to join house information onto summary_PVQ</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a>summary_PVQ <span class="ot">&lt;-</span> <span class="fu">left_join</span>(summary_PVQ, demog) <span class="sc">%&gt;%</span> </span>
<span id="cb62-2"><a href="#cb62-2"></a>  <span class="fu">drop_na</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(PP_ID)`</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> summary_PVQ, <span class="fu">aes</span>(<span class="at">x =</span> Dimension, <span class="at">y =</span> PVQ_score)) <span class="sc">+</span></span>
<span id="cb64-2"><a href="#cb64-2"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span></span>
<span id="cb64-3"><a href="#cb64-3"></a>  <span class="fu">geom_boxplot</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-vb" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="03-dataviz_files/figure-html/fig-vb-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;3.8: default Violin boxplot</figcaption></figure>
</div>
</div>
</div>
<p>Let’s see if we can make this plot pretty. We could</p>
<ul>
<li>change the colour</li>
<li>change the width of the boxes. at the moment they are covering the violins</li>
<li>change the axes labels</li>
<li>change the breaks on the y axis</li>
<li>set the limits on the y axis from 0 to 6</li>
<li>dodge the axis labels on the x axis so they so they don’t overlap</li>
<li>change the theme to classic</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> summary_PVQ, <span class="fu">aes</span>(<span class="at">x =</span> Dimension, <span class="at">y =</span> PVQ_score, <span class="at">fill =</span> Dimension)) <span class="sc">+</span></span>
<span id="cb65-2"><a href="#cb65-2"></a>  <span class="fu">geom_violin</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="co"># alpha changes transparency</span></span>
<span id="cb65-3"><a href="#cb65-3"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.25</span>) <span class="sc">+</span> <span class="co"># change the width of the boxes</span></span>
<span id="cb65-4"><a href="#cb65-4"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">guide =</span> <span class="st">"none"</span>, <span class="co"># remove the legend</span></span>
<span id="cb65-5"><a href="#cb65-5"></a>                       <span class="at">option =</span> <span class="st">"plasma"</span>) <span class="sc">+</span> <span class="co"># changes colour scheme to viridis option plasma</span></span>
<span id="cb65-6"><a href="#cb65-6"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">"PVQ Score"</span>, <span class="co"># change y axis label</span></span>
<span id="cb65-7"><a href="#cb65-7"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">6</span>, <span class="at">by =</span> <span class="dv">1</span>), <span class="co"># change the breaks ticks on the y axis</span></span>
<span id="cb65-8"><a href="#cb65-8"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">6</span>)) <span class="sc">+</span> <span class="co"># min = 0, max = 6</span></span>
<span id="cb65-9"><a href="#cb65-9"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">name =</span> <span class="st">"Human Values"</span>,</span>
<span id="cb65-10"><a href="#cb65-10"></a>                   <span class="at">guide =</span> <span class="fu">guide_axis</span>(<span class="at">n.dodge =</span> <span class="dv">2</span>)) <span class="sc">+</span> <span class="co"># want display labels in 2 rows</span></span>
<span id="cb65-11"><a href="#cb65-11"></a>  <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-vb_pretty" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="03-dataviz_files/figure-html/fig-vb_pretty-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;3.9: Pretty violin boxplot</figcaption></figure>
</div>
</div>
</div>
<p>If we wanted to <strong>add another grouping variable</strong> to the mix, for example, Sorting_house, we can use <code>facet_wrap()</code> to create a separate plot for each level of variable we are separating by (in this case Dimension). For clarity, we should …</p>
<ul>
<li>re-define <code>x = Sorting_house</code>
</li>
<li>change the fill variable - it makes more sense to have Sorting_house there</li>
<li>adjust the x axis label</li>
</ul>
<p>… so our plot shows a better comparison how the 4 houses compare for each human value dimension.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> summary_PVQ, <span class="fu">aes</span>(<span class="at">x =</span> Sorting_house, <span class="at">y =</span> PVQ_score, <span class="at">fill =</span> Sorting_house)) <span class="sc">+</span></span>
<span id="cb66-2"><a href="#cb66-2"></a>  <span class="fu">geom_violin</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="co"># alpha changes transparency</span></span>
<span id="cb66-3"><a href="#cb66-3"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.25</span>) <span class="sc">+</span> <span class="co"># change the width of the boxes</span></span>
<span id="cb66-4"><a href="#cb66-4"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">guide =</span> <span class="st">"none"</span>, <span class="co"># remove the legend</span></span>
<span id="cb66-5"><a href="#cb66-5"></a>                       <span class="at">option =</span> <span class="st">"plasma"</span>) <span class="sc">+</span> <span class="co"># changes colour scheme to viridis option plasma</span></span>
<span id="cb66-6"><a href="#cb66-6"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">"PVQ Score"</span>, <span class="co"># change y axis label</span></span>
<span id="cb66-7"><a href="#cb66-7"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">6</span>, <span class="at">by =</span> <span class="dv">1</span>), <span class="co"># change the breaks ticks on the y axis</span></span>
<span id="cb66-8"><a href="#cb66-8"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">6</span>)) <span class="sc">+</span> <span class="co"># min = 0, max = 6</span></span>
<span id="cb66-9"><a href="#cb66-9"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">name =</span> <span class="st">"Houses sorted into"</span>,</span>
<span id="cb66-10"><a href="#cb66-10"></a>                   <span class="at">guide =</span> <span class="fu">guide_axis</span>(<span class="at">n.dodge =</span> <span class="dv">2</span>)) <span class="sc">+</span> <span class="co"># want display labels in 2 rows</span></span>
<span id="cb66-11"><a href="#cb66-11"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb66-12"><a href="#cb66-12"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Dimension) <span class="sc">+</span> <span class="co"># I want them in all on an individual rows otherwise their labels overlap again</span></span>
<span id="cb66-13"><a href="#cb66-13"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="co"># move legend to the bottom</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-vb_pretty_facet" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="03-dataviz_files/figure-html/fig-vb_pretty_facet-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;3.10: Pretty violin boxplot with facet_wrap</figcaption></figure>
</div>
</div>
</div>
</section></section><section id="two-continuous" class="level3" data-number="3.6.5"><h3 data-number="3.6.5" class="anchored" data-anchor-id="two-continuous">
<span class="header-section-number">3.6.5</span> Two continuous</h3>
<p>scatterplot</p>
<p>trendlines straight line vs loess</p>
</section></section><section id="save-your-plots" class="level2" data-number="3.7"><h2 data-number="3.7" class="anchored" data-anchor-id="save-your-plots">
<span class="header-section-number">3.7</span> Save your plots</h2>
<p>You can save your figures with the function <code>ggsave()</code>. It will save to your project folder</p>
<p>There are two ways you can use <code>ggsave()</code>. If you don’t tell <code>ggsave()</code> which plot you want to save, by <strong>default</strong> it will <strong>save the last plot you created</strong>. If you have followed the steps above, your last plot would be the scatterplot from <span class="quarto-unresolved-ref">?fig-scatter</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"scatterplot.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The second option is to save a plot as an object. As an example, let’s save the boxplot we recreated from Jakob et al.&nbsp;(2019) above (<a href="#fig-recreated">Figure&nbsp;<span>3.7</span></a>) as an object called <code>recreated_boxplot</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a>recreated_boxplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> personality, <span class="fu">aes</span>(<span class="at">x =</span> Dimension, <span class="at">y =</span> Score, <span class="at">fill =</span> Sorting_house)) <span class="sc">+</span></span>
<span id="cb68-2"><a href="#cb68-2"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span> <span class="co"># add alpha here</span></span>
<span id="cb68-3"><a href="#cb68-3"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">'#7F0909'</span>, <span class="st">'#f0c75e'</span>, <span class="st">'#08245e'</span>, <span class="st">'#2a623d'</span>),</span>
<span id="cb68-4"><a href="#cb68-4"></a>                    <span class="at">name =</span> <span class="st">""</span>) <span class="sc">+</span> <span class="co"># delete the fill variable's title</span></span>
<span id="cb68-5"><a href="#cb68-5"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">name =</span> <span class="st">"Personality Traits"</span>,</span>
<span id="cb68-6"><a href="#cb68-6"></a>                   <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Agreeabl."</span>, <span class="st">"Conscient."</span>, <span class="st">"EmStability"</span>, <span class="st">"Extraversion"</span>, <span class="st">"Intellect"</span>, <span class="st">"Machiav."</span>, <span class="st">"Narcissism"</span>, <span class="st">"Psychopathy"</span>)) <span class="sc">+</span></span>
<span id="cb68-7"><a href="#cb68-7"></a>  <span class="fu">ggtitle</span>(<span class="st">"Personality Traits across Houses"</span>) <span class="sc">+</span></span>
<span id="cb68-8"><a href="#cb68-8"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="co"># remove grey background</span></span>
<span id="cb68-9"><a href="#cb68-9"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb68-10"><a href="#cb68-10"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="co"># centers the title (took quite a bit of digging how to do that)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then you run the line</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"recreated_boxplot.png"</span>, </span>
<span id="cb69-2"><a href="#cb69-2"></a>       <span class="at">plot =</span> recreated_boxplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
</div>
<p>Filename is the name you want your png to be called, plot refers to the object name.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-14-contents" aria-controls="callout-14" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Our saved <code>recreated_boxplot.png</code> would look like this:
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-14" class="callout-14-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><img src="recreated_boxplot.png" class="img-fluid"></p>
</div>
</div>
</div>
<p>That is with default settings. If you like it, keep it, but if you think it looks a bit “stretched”, you can specify the width, the height, and the units (e.g., “cm”, “mm”, “in”, “px” are possible). You might need to play about with the dimension before it feels right.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"recreated_boxplot2.png"</span>, </span>
<span id="cb71-2"><a href="#cb71-2"></a>       <span class="at">plot =</span> recreated_boxplot, </span>
<span id="cb71-3"><a href="#cb71-3"></a>       <span class="at">width =</span> <span class="dv">16</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-15-contents" aria-controls="callout-15" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
png with different dimensions
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-15" class="callout-15-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><img src="recreated_boxplot2.png" class="img-fluid"></p>
</div>
</div>
</div>
</section><section id="pair-coding-in-the-lab" class="level2 unnumbered"><h2 class="unnumbered anchored" data-anchor-id="pair-coding-in-the-lab"><span style="color: #EBA347; text-transform: uppercase;">Pair-coding in the lab</span></h2>
<p>Provide a barchart, a violin-boxplot, and a scatterplot from the loneliness data and the students have to try and recreate one of those in the lab. If they are overly fast, they can do the other 2.</p>
</section><section id="test-your-knowledge" class="level2 unnumbered"><h2 class="unnumbered anchored" data-anchor-id="test-your-knowledge"><span style="color: #EBA347; text-transform: uppercase;">Test your knowledge</span></h2>
<p>Which plot would you choose for</p>


</section></main><!-- /main --><script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  var t = document.getElementsByClassName("webex-total_correct");
  for (var i = 0; i < t.length; i++) {
    p = t[i].parentElement;
    var correct = p.getElementsByClassName("webex-correct").length;
    var solvemes = p.getElementsByClassName("webex-solveme").length;
    var radiogroups = p.getElementsByClassName("webex-radiogroup").length;
    var selects = p.getElementsByClassName("webex-select").length;

    t[i].innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");

  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* check answers */
check_func = function() {
  console.log("webex: check answers");

  var cl = this.parentElement.classList;
  if (cl.contains('unchecked')) {
    cl.remove("unchecked");
    this.innerHTML = "Hide Answers";
  } else {
    cl.add("unchecked");
    this.innerHTML = "Show Answers";
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");

  var cl = this.classList

  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;

  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }

  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

window.onload = function() {
  console.log("webex onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  var check_sections = document.getElementsByClassName("webex-check");
  console.log("check:", check_sections.length);
  for (var i = 0; i < check_sections.length; i++) {
    check_sections[i].classList.add("unchecked");

    let btn = document.createElement("button");
    btn.innerHTML = "Show Answers";
    btn.classList.add("webex-check-button");
    btn.onclick = check_func;
    check_sections[i].appendChild(btn);

    let spn = document.createElement("span");
    spn.classList.add("webex-total_correct");
    check_sections[i].appendChild(spn);
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;

    solveme[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }

  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
    selects[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  update_total_correct();
}

</script><script>
// open rdrr links externally ----

var exlinks = document.querySelectorAll("a[href^='https://rdrr.io']");
var exlink_func = function(){
  window.open(this.href);
  return false;
};
for (var i = 0; i < exlinks.length; i++) {
    exlinks[i].addEventListener('click', exlink_func, false);
}

// visible second sidebar in mobile ----

function move_sidebar() {
  var toc = document.getElementById("TOC");
  var small_sidebar = document.querySelector("#quarto-sidebar .sidebar-menu-container");
  var right_sidebar = document.getElementById("quarto-margin-sidebar");

  if (window.innerWidth < 768) {
    small_sidebar.append(toc);
  } else {
    right_sidebar.append(toc);
  }
}
move_sidebar();
window.onresize = move_sidebar;
</script><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./02-wrangling.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data wrangling</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./04-prob-binom-one-sample.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Revisiting probability and introduction to NHST</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">CC-BY (2024) Gaby Mahrholz</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>


</body></html>