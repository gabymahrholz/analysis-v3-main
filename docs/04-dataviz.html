<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="description" content="Level 2 UG Analysis book">
<title>Analysis - 4&nbsp; Data viz I</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./05-dataviz2.html" rel="next">
<link href="./03-wrangling2.html" rel="prev">
<link href="./images/logos/logo_analysis.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.13.0/css/all.css">
<link rel="stylesheet" href="include/booktem.css">
<link rel="stylesheet" href="include/webex.css">
<link rel="stylesheet" href="include/glossary.css">
<link rel="stylesheet" href="include/style.css">
<link rel="stylesheet" href="include/custom.scss">
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./04-dataviz.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data viz I</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Analysis</a> 
        <div class="sidebar-tools-main">
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
<li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=%7Curl%7C">
              <i class="bi bi-bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=%7Curl%7C">
              <i class="bi bi-bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=%7Curl%7C">
              <i class="bi bi-bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
</div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Projects, R Markdown, and Data Wrangling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-wrangling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data wrangling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-wrangling2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data wrangling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-dataviz.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data viz I</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-dataviz2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Data viz II</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-chi-square-one-sample.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Chi-square and one-sample t-test</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-independent.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Two-sample t-test</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-paired.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Paired t-test</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-correlation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Correlations</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Simple regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-multiple-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Multiple regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-one-way-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">One-way ANOVA</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-factorial-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Factorial ANOVA</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix-a-installing-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Installing R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix-b-updating-packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Updating R, RStudio, and packages</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix-c-exporting-server.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Exporting files from the server</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix-d-symbols.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Symbols</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix-x-How-to-cite-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Citing R and RStudio</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix-y-license.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">License</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#intended-learning-outcomes" id="toc-intended-learning-outcomes" class="nav-link active" data-scroll-target="#intended-learning-outcomes">Intended Learning Outcomes</a></li>
  <li><a href="#individual-walkthrough" id="toc-individual-walkthrough" class="nav-link" data-scroll-target="#individual-walkthrough"><span style="color: #F39C12; text-transform: uppercase;">Individual Walkthrough</span></a></li>
  <li><a href="#building-plots" id="toc-building-plots" class="nav-link" data-scroll-target="#building-plots"><span class="header-section-number">4.1</span> Building plots</a></li>
  <li><a href="#activity-1-set-up-and-data-for-today" id="toc-activity-1-set-up-and-data-for-today" class="nav-link" data-scroll-target="#activity-1-set-up-and-data-for-today"><span class="header-section-number">4.2</span> Activity 1: Set-up and data for today</a></li>
  <li><a href="#activity-2-load-in-the-libraries-read-in-the-data-and-tidy-the-dataframe" id="toc-activity-2-load-in-the-libraries-read-in-the-data-and-tidy-the-dataframe" class="nav-link" data-scroll-target="#activity-2-load-in-the-libraries-read-in-the-data-and-tidy-the-dataframe"><span class="header-section-number">4.3</span> Activity 2: Load in the libraries, read in the data, and tidy the dataframe</a></li>
  <li><a href="#appropriate-plots" id="toc-appropriate-plots" class="nav-link" data-scroll-target="#appropriate-plots">Appropriate plots?</a></li>
  <li>
<a href="#one-categorical-variable" id="toc-one-categorical-variable" class="nav-link" data-scroll-target="#one-categorical-variable"><span class="header-section-number">4.4</span> One categorical variable</a>
  <ul class="collapse">
<li><a href="#barchart-geom_bar" id="toc-barchart-geom_bar" class="nav-link" data-scroll-target="#barchart-geom_bar"><span class="header-section-number">4.4.1</span> Barchart (<code>geom_bar()</code>)</a></li>
  <li><a href="#column-plot-geom_col" id="toc-column-plot-geom_col" class="nav-link" data-scroll-target="#column-plot-geom_col"><span class="header-section-number">4.4.2</span> Column plot (<code>geom_col()</code>)</a></li>
  <li><a href="#activity-3-make-the-column-plot-pretty" id="toc-activity-3-make-the-column-plot-pretty" class="nav-link" data-scroll-target="#activity-3-make-the-column-plot-pretty"><span class="header-section-number">4.4.3</span> Activity 3: Make the column plot pretty</a></li>
  </ul>
</li>
  <li>
<a href="#two-categorical-variables" id="toc-two-categorical-variables" class="nav-link" data-scroll-target="#two-categorical-variables"><span class="header-section-number">4.5</span> Two categorical variables</a>
  <ul class="collapse">
<li><a href="#stacked-and-percent-stacked-barchart" id="toc-stacked-and-percent-stacked-barchart" class="nav-link" data-scroll-target="#stacked-and-percent-stacked-barchart"><span class="header-section-number">4.5.1</span> Stacked and percent stacked barchart</a></li>
  <li><a href="#grouped-barchart" id="toc-grouped-barchart" class="nav-link" data-scroll-target="#grouped-barchart"><span class="header-section-number">4.5.2</span> Grouped barchart</a></li>
  </ul>
</li>
  <li><a href="#activity-4-save-your-plots" id="toc-activity-4-save-your-plots" class="nav-link" data-scroll-target="#activity-4-save-your-plots"><span class="header-section-number">4.6</span> Activity 4: Save your plots</a></li>
  <li><a href="#activity-5-your-turn" id="toc-activity-5-your-turn" class="nav-link" data-scroll-target="#activity-5-your-turn"><span class="header-section-number">4.7</span> Activity 5: Your Turn</a></li>
  <li><a href="#pair-coding-in-the-lab" id="toc-pair-coding-in-the-lab" class="nav-link" data-scroll-target="#pair-coding-in-the-lab"><span style="color: #F39C12; text-transform: uppercase;">Pair-coding in the lab</span></a></li>
  <li><a href="#test-your-knowledge" id="toc-test-your-knowledge" class="nav-link" data-scroll-target="#test-your-knowledge"><span style="color: #F39C12; text-transform: uppercase;">Test your knowledge</span></a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="sec-dataviz" class="quarto-section-identifier"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data viz I</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><section id="intended-learning-outcomes" class="level2 unnumbered"><h2 class="unnumbered anchored" data-anchor-id="intended-learning-outcomes">Intended Learning Outcomes</h2>
<p>By the end of this chapter you should be able to:</p>
<ul>
<li>explain the layered grammar of graphics</li>
<li>choose an appropriate plot for categorical variables</li>
<li>create a basic version of an appropriate plot</li>
<li>apply extra layers to change the appearance of the plot</li>
</ul></section><section id="individual-walkthrough" class="level2 unnumbered"><h2 class="unnumbered anchored" data-anchor-id="individual-walkthrough"><span style="color: #F39C12; text-transform: uppercase;">Individual Walkthrough</span></h2>
</section><section id="building-plots" class="level2" data-number="4.1"><h2 data-number="4.1" class="anchored" data-anchor-id="building-plots">
<span class="header-section-number">4.1</span> Building plots</h2>
<p>We are using the package <code>ggplot2</code> to create data visualisations. It’s part of the tidyverse package. Actually, most people call th package <code>ggplot</code> but it’s official name is <code>ggplot2</code>.</p>
<div class="grid">
<div class="g-col-5">
<p><strong>ggplot2</strong> uses a layered grammar of graphics, in which plots are built up in a series of layers. You would start with a base layer (opening ggplot), adding <strong>data</strong> and <strong>aesthetics</strong>, and selecting the <strong>geometries</strong> for plot.</p>
<p>These first 3 layers will give you the most simple version of a complete plot, but you could add other layers to make the plots pretty by using <strong>scales</strong>, <strong>facets</strong>, <strong>coordinates</strong>, <strong>labels</strong> and <strong>themes</strong>.</p>
</div>
<div class="g-col-7">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="images/gglayers.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">gg layers <a href="https://metricsf20.classes.ryansafner.com/slides/1.3-slides#20" target="_blank">(Presentation by Ryan Safner)</a></figcaption></figure>
</div>
</div>
</div>
<p>To give you a brief overview of the layering system, let’s use the package <code>palmerpenguins</code> (<a href="https://allisonhorst.github.io/palmerpenguins/" target="_blank">https://allisonhorst.github.io/palmerpenguins/</a>). It contains data about bill length and depth, flipper length, and body mass, etc.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">head</span>(penguins)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 8%">
<col style="width: 11%">
<col style="width: 16%">
<col style="width: 15%">
<col style="width: 20%">
<col style="width: 13%">
<col style="width: 7%">
<col style="width: 5%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">species</th>
<th style="text-align: left;">island</th>
<th style="text-align: right;">bill_length_mm</th>
<th style="text-align: right;">bill_depth_mm</th>
<th style="text-align: right;">flipper_length_mm</th>
<th style="text-align: right;">body_mass_g</th>
<th style="text-align: left;">sex</th>
<th style="text-align: right;">year</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Adelie</td>
<td style="text-align: left;">Torgersen</td>
<td style="text-align: right;">39.1</td>
<td style="text-align: right;">18.7</td>
<td style="text-align: right;">181</td>
<td style="text-align: right;">3750</td>
<td style="text-align: left;">male</td>
<td style="text-align: right;">2007</td>
</tr>
<tr class="even">
<td style="text-align: left;">Adelie</td>
<td style="text-align: left;">Torgersen</td>
<td style="text-align: right;">39.5</td>
<td style="text-align: right;">17.4</td>
<td style="text-align: right;">186</td>
<td style="text-align: right;">3800</td>
<td style="text-align: left;">female</td>
<td style="text-align: right;">2007</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Adelie</td>
<td style="text-align: left;">Torgersen</td>
<td style="text-align: right;">40.3</td>
<td style="text-align: right;">18.0</td>
<td style="text-align: right;">195</td>
<td style="text-align: right;">3250</td>
<td style="text-align: left;">female</td>
<td style="text-align: right;">2007</td>
</tr>
<tr class="even">
<td style="text-align: left;">Adelie</td>
<td style="text-align: left;">Torgersen</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">2007</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Adelie</td>
<td style="text-align: left;">Torgersen</td>
<td style="text-align: right;">36.7</td>
<td style="text-align: right;">19.3</td>
<td style="text-align: right;">193</td>
<td style="text-align: right;">3450</td>
<td style="text-align: left;">female</td>
<td style="text-align: right;">2007</td>
</tr>
<tr class="even">
<td style="text-align: left;">Adelie</td>
<td style="text-align: left;">Torgersen</td>
<td style="text-align: right;">39.3</td>
<td style="text-align: right;">20.6</td>
<td style="text-align: right;">190</td>
<td style="text-align: right;">3650</td>
<td style="text-align: left;">male</td>
<td style="text-align: right;">2007</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Let’s build a basic scatterplot to show the relationship between <code>flipper_length</code> and <code>body_mass</code>. We will customise plots further later on in the individual plots. This is just a quick overview of the different layers.</p>
<ul>
<li>Layer 1 creates a plot base to built up upon.</li>
<li>Layer 2 adds the <code>data</code> and some <code>aesthetics</code>
<ul>
<li>data is first argument</li>
<li>aesthetics are added via the mapping argument. There you define your variables to be added (such as x, or x and y) and allows you specify overall properties like the colour of grouping variables etc.</li>
</ul>
</li>
<li>Layer 3 adds the geometries or <code>geom_?</code> for short. This tells ggplot in which style we want to plot the data points. Remember to add these layers with a <code>+</code> rather than a pipe <code>%&gt;%</code>. You can add multiple geoms if you wish, e.g., building a violin-boxplot</li>
<li>Layer 4 adds the <code>scale_?</code> functions which can help you customise the aesthetics, such as changing colour. You can do much more with scales, but we’ll get to that later.</li>
<li>Layer 5 introduces <code>facets</code>, such as <code>facet_wrap()</code> which allows you to add another dimension to the data output by showing the relationship you are interested in for each level of a categorical variable.</li>
<li>Layer 6 - coordinates: <code>coord_cartesian()</code> controls the limits for the x- and y-axes (arguments <code>xlim</code> and <code>ylim</code>). Changing those allows you to zoom in or out of your plot.</li>
<li>Layer 7 helps you to modify axes labels.</li>
<li>Layer 8 controls the general style of a ggplot (e.g., background colour, size of text, borders, etc.). R comes with a few pre-defined ones (like <code>theme_classic</code>, <code>theme_bw</code>, <code>theme_minimal</code>, <code>theme_light</code>).</li>
</ul>
<p>Click on the tabs below to see how each layer contributes to refining the plot.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">Layer 1</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Layer 2</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Layer 3</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false">Layer 4</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-5" role="tab" aria-controls="tabset-1-5" aria-selected="false">Layer 5</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-6" role="tab" aria-controls="tabset-1-6" aria-selected="false">Layer 6</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-7" role="tab" aria-controls="tabset-1-7" aria-selected="false">Layer 7</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-8" role="tab" aria-controls="tabset-1-8" aria-selected="false">Layer 8</a></li>
</ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="fu">ggplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="04-dataviz_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>We don’t see much here. It’s basically an empty plot layer.</p>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> penguins, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>body_mass_g, <span class="at">y=</span>flipper_length_mm))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="04-dataviz_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>You won’t see any data points yet, because we haven’t specified how we want to display the data points. But we mapped in the aesthetics, that we want to plot variable body mass on the x-axis and flipper length on the y-axis. This also adds the axes titles and the values and break points of the axes.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>You won’t need to add <code>data =</code> or <code>mapping =</code> if you keep those arguments in exactly that order. Likewise, the first column name you enter within the <code>aes()</code> function will always be interpreted as x, and the second as y, so you could omit them if you wish.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="fu">ggplot</span>(penguins, <span class="fu">aes</span>(body_mass_g, flipper_length_mm))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>will give you the same output as the code above.</p>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> penguins, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>body_mass_g, <span class="at">y=</span>flipper_length_mm, <span class="at">colour=</span>sex)) <span class="sc">+</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="04-dataviz_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Here we are telling ggplot that we want a scatterplot added. There is a warning displayed showing that rows were removed because of missing values.</p>
<p>The argument <code>colour</code> adds colour to the points according to a grouping variable (in this case sex). If you want all of the points to be black (i.e.&nbsp;only represent 2 rather than 3 dimensions of the data), leave the <code>colour</code> argument out.</p>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> penguins, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>body_mass_g, <span class="at">y=</span>flipper_length_mm, <span class="at">colour=</span>sex)) <span class="sc">+</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb7-3"><a href="#cb7-3"></a>  <span class="co"># changes colour palette</span></span>
<span id="cb7-4"><a href="#cb7-4"></a>  <span class="fu">scale_colour_brewer</span>(<span class="at">palette =</span> <span class="st">"Dark2"</span>) <span class="sc">+</span> </span>
<span id="cb7-5"><a href="#cb7-5"></a>  <span class="co"># add breaks from 2500 to 6500 in increasing steps of 500</span></span>
<span id="cb7-6"><a href="#cb7-6"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">2500</span>, <span class="at">to =</span> <span class="dv">6500</span>, <span class="at">by =</span> <span class="dv">500</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 11 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="04-dataviz_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>The <code>scale_?</code> functions allow us to change the colour palette of the plot or the axes breaks etc. You could change the name of the axis in <code>scale_x_continuous()</code> as well or leave it for Layer 7.</p>
</div>
<div id="tabset-1-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-5-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> penguins, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>body_mass_g, <span class="at">y=</span>flipper_length_mm, <span class="at">colour=</span>sex)) <span class="sc">+</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb9-3"><a href="#cb9-3"></a>  <span class="fu">scale_colour_brewer</span>(<span class="at">palette =</span> <span class="st">"Dark2"</span>) <span class="sc">+</span> </span>
<span id="cb9-4"><a href="#cb9-4"></a>  <span class="co"># split main plot up into different subplots by species </span></span>
<span id="cb9-5"><a href="#cb9-5"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> species) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 11 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="04-dataviz_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Here we are faceting this plot out for the individual species.</p>
</div>
<div id="tabset-1-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-6-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> penguins, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>body_mass_g, <span class="at">y=</span>flipper_length_mm, <span class="at">colour=</span>sex)) <span class="sc">+</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb11-3"><a href="#cb11-3"></a>  <span class="fu">scale_colour_brewer</span>(<span class="at">palette =</span> <span class="st">"Dark2"</span>) <span class="sc">+</span> </span>
<span id="cb11-4"><a href="#cb11-4"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> species) <span class="sc">+</span></span>
<span id="cb11-5"><a href="#cb11-5"></a>  <span class="co"># limits the range of the y axis</span></span>
<span id="cb11-6"><a href="#cb11-6"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">250</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 11 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="04-dataviz_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Changing the limits of the y axis to zoom in or out of the plot. If you wanted to the same for the x axis, you would add an argument <code>xlim</code> to the <code>coord_cartesian()</code> function.</p>
</div>
<div id="tabset-1-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-7-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> penguins, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>body_mass_g, <span class="at">y=</span>flipper_length_mm, <span class="at">colour=</span>sex)) <span class="sc">+</span></span>
<span id="cb13-2"><a href="#cb13-2"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3"></a>  <span class="fu">scale_colour_brewer</span>(<span class="at">palette =</span> <span class="st">"Dark2"</span>) <span class="sc">+</span> </span>
<span id="cb13-4"><a href="#cb13-4"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> species) <span class="sc">+</span></span>
<span id="cb13-5"><a href="#cb13-5"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Body Mass (in g)"</span>, <span class="co"># labels the x axis</span></span>
<span id="cb13-6"><a href="#cb13-6"></a>       <span class="at">y =</span> <span class="st">"Flipper length (in mm)"</span>, <span class="co"># labels the y axis</span></span>
<span id="cb13-7"><a href="#cb13-7"></a>       <span class="at">colour =</span> <span class="st">"Sex"</span>) <span class="co"># labels the grouping variable in the legend</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 11 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="04-dataviz_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>You can change the axes labels via the <code>labs()</code> function or include that step when modifying the scales (i.e.&nbsp;in the <code>scale_x_continuous()</code> function).</p>
</div>
<div id="tabset-1-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-8-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> penguins, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>body_mass_g, <span class="at">y=</span>flipper_length_mm, <span class="at">colour=</span>sex)) <span class="sc">+</span></span>
<span id="cb15-2"><a href="#cb15-2"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb15-3"><a href="#cb15-3"></a>  <span class="fu">scale_colour_brewer</span>(<span class="at">palette =</span> <span class="st">"Dark2"</span>) <span class="sc">+</span> </span>
<span id="cb15-4"><a href="#cb15-4"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> species) <span class="sc">+</span></span>
<span id="cb15-5"><a href="#cb15-5"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Body Mass (in g)"</span>, </span>
<span id="cb15-6"><a href="#cb15-6"></a>       <span class="at">y =</span> <span class="st">"Flipper length (in mm)"</span>,</span>
<span id="cb15-7"><a href="#cb15-7"></a>       <span class="at">colour =</span> <span class="st">"Sex"</span>) <span class="sc">+</span></span>
<span id="cb15-8"><a href="#cb15-8"></a>  <span class="co"># add a theme</span></span>
<span id="cb15-9"><a href="#cb15-9"></a>  <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 11 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="04-dataviz_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p><code>theme_classic()</code> is applied to change the overall appearance of the plot.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>You need to stick to the first 3 layers to get your base plot. Everything else is optional meaning you don’t have to use all 8 layers in a plot. And layers 4-8 can be added in a random order whereas layers 1-3 are fixed.</p>
</div>
</div>
</section><section id="activity-1-set-up-and-data-for-today" class="level2" data-number="4.2"><h2 data-number="4.2" class="anchored" data-anchor-id="activity-1-set-up-and-data-for-today">
<span class="header-section-number">4.2</span> Activity 1: Set-up and data for today</h2>
<ul>
<li>We are still working with the data by Pownall et al.&nbsp;(2023) which we aggregated in <a href="03-wrangling2.html"><span>Chapter&nbsp;3</span></a>. So, open your project.</li>
<li>However, we could do with a fresh Rmd: Create a new Rmd and save it to your project folder. Name it something meaningful (e.g., “chapter_03”, “03_data_viz.Rmd”). See <a href="01-basics.html#sec-rmd"><span>Section&nbsp;1.3</span></a> if you need some guidance. Delete everything below line 12 (keep the set-up code chunk)</li>
<li>We aggregated the data in <a href="03-wrangling2.html"><span>Chapter&nbsp;3</span></a>. If you want a fresh copy, download the data here: <a href="data/data_prp_ch3.csv" title="download">data_prp_ch3.csv</a>. Make sure to place the csv file in the same folder.</li>
<li>If you need a reminder about the data and variables, have a look at the codebook and/or <a href="01-basics.html#sec-download_data_ch1"><span>Section&nbsp;1.4</span></a>.</li>
</ul></section><section id="activity-2-load-in-the-libraries-read-in-the-data-and-tidy-the-dataframe" class="level2" data-number="4.3"><h2 data-number="4.3" class="anchored" data-anchor-id="activity-2-load-in-the-libraries-read-in-the-data-and-tidy-the-dataframe">
<span class="header-section-number">4.3</span> Activity 2: Load in the libraries, read in the data, and tidy the dataframe</h2>
<p>We need the package <code>tidyverse</code> today, and the data <code>data_prp_ch3.csv</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="do">## packages </span></span>
<span id="cb17-2"><a href="#cb17-2"></a>???</span>
<span id="cb17-3"><a href="#cb17-3"></a></span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="do">## data</span></span>
<span id="cb17-5"><a href="#cb17-5"></a>data_prp_viz <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(???)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb18-2"><a href="#cb18-2"></a>data_prp_viz <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data_prp_ch3.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<section id="re-familiarise-yourself-with-the-data-structure" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="re-familiarise-yourself-with-the-data-structure">Re-familiarise yourself with the data structure</h4>
<p>As we said in <a href="01-basics.html#sec-familiarise"><span>Section&nbsp;1.6</span></a>, it is always recommended to glimpse at the data to see how many variables and observations there are in the dataset and what kind of data type they are.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
glimpse output
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="fu">glimpse</span>(data_prp_viz)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 89
Columns: 28
$ Code                                  &lt;chr&gt; "Tr10", "Bi07", "SK03", "SM95", …
$ Gender                                &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 3, 2, 2,…
$ Age                                   &lt;dbl&gt; 22, 20, 22, 26, 22, 20, 21, 21, …
$ Ethnicity                             &lt;chr&gt; "White European", "White British…
$ Secondyeargrade                       &lt;dbl&gt; 2, 3, 1, 2, 2, 2, 2, 2, 1, 1, 1,…
$ Opptional_mod                         &lt;dbl&gt; 1, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2,…
$ Opptional_mod_1_TEXT                  &lt;chr&gt; "Research methods in first year"…
$ Research_exp                          &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,…
$ Research_exp_1_TEXT                   &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, …
$ Plan_prereg                           &lt;dbl&gt; 1, 3, 1, 2, 1, 1, 3, 3, 2, 2, 2,…
$ Pre_reg_group                         &lt;dbl&gt; 1, 1, 1, 2, 1, 1, 1, 2, 2, 1, 2,…
$ SATS28_Affect_Time1_mean              &lt;dbl&gt; 4.000000, 3.833333, 5.000000, 5.…
$ SATS28_CognitiveCompetence_Time1_mean &lt;dbl&gt; 5.166667, 5.166667, 5.666667, 4.…
$ SATS28_Value_Time1_mean               &lt;dbl&gt; 6.000000, 6.666667, 5.222222, 5.…
$ SATS28_Difficulty_Time1_mean          &lt;dbl&gt; 3.571429, 2.428571, 3.571429, 3.…
$ QRPs_Acceptance_Time1_mean            &lt;dbl&gt; 5.909091, 6.090909, 6.545455, 5.…
$ Time1_Understanding_OS                &lt;dbl&gt; 5.500000, 3.166667, 4.500000, 3.…
$ Other_OS_behav_2                      &lt;dbl&gt; 1, NA, NA, NA, 1, NA, NA, 1, NA,…
$ Other_OS_behav_4                      &lt;dbl&gt; 1, NA, NA, NA, NA, NA, NA, NA, N…
$ Other_OS_behav_5                      &lt;dbl&gt; NA, NA, NA, NA, 1, 1, NA, NA, NA…
$ Closely_follow                        &lt;dbl&gt; 2, 2, 2, NA, 3, 3, 3, NA, NA, 2,…
$ SATS28_Affect_Time2_mean              &lt;dbl&gt; 3.500000, 3.166667, 4.833333, 4.…
$ SATS28_CognitiveCompetence_Time2_mean &lt;dbl&gt; 4.166667, 4.666667, 6.166667, 5.…
$ SATS28_Value_Time2_mean               &lt;dbl&gt; 3.000000, 6.222222, 6.000000, 4.…
$ SATS28_Difficulty_Time2_mean          &lt;dbl&gt; 2.857143, 2.857143, 4.000000, 2.…
$ QRPs_Acceptance_Time2_mean            &lt;dbl&gt; 5.636364, 5.454545, 6.272727, 5.…
$ Time2_Understanding_OS                &lt;dbl&gt; 5.583333, 3.333333, 5.416667, 4.…
$ Mean_Supervisor_Support               &lt;dbl&gt; 5.230769, 6.285714, 6.857143, 2.…</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>We can see that some of the categorical data in <code>data_prp_viz</code> was read in as numeric variables which makes them continuous. This is going to haunt us big time when building the plots. We would be better off addressing these changes in the dataset before we start plotting (and potentially getting frustrated with R and data viz in general)</p>
<p>Let’s turn a few of the categorical variables into factors.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>data_prp_viz <span class="ot">&lt;-</span> data_prp_viz <span class="sc">%&gt;%</span> </span>
<span id="cb21-2"><a href="#cb21-2"></a>  <span class="fu">mutate</span>(<span class="at">Gender =</span> <span class="fu">factor</span>(Gender,</span>
<span id="cb21-3"><a href="#cb21-3"></a>                         <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">3</span>),</span>
<span id="cb21-4"><a href="#cb21-4"></a>                         <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"females"</span>, <span class="st">"males"</span>, <span class="st">"non-binary"</span>)),</span>
<span id="cb21-5"><a href="#cb21-5"></a>         <span class="at">Secondyeargrade =</span> <span class="fu">factor</span>(Secondyeargrade,</span>
<span id="cb21-6"><a href="#cb21-6"></a>                                  <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>),</span>
<span id="cb21-7"><a href="#cb21-7"></a>                                  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"≥ 70% (1st class grade)"</span>, <span class="st">"60-69% (2:1 grade)"</span>, <span class="st">"50-59% (2:2 grade)"</span>, <span class="st">"40-49% (3rd class)"</span>, <span class="st">"&lt; 40%"</span>)),</span>
<span id="cb21-8"><a href="#cb21-8"></a>         <span class="at">Plan_prereg =</span> <span class="fu">factor</span>(Plan_prereg,</span>
<span id="cb21-9"><a href="#cb21-9"></a>                              <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>),</span>
<span id="cb21-10"><a href="#cb21-10"></a>                              <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Yes"</span>, <span class="st">"Unsure"</span>, <span class="st">"No"</span>)),</span>
<span id="cb21-11"><a href="#cb21-11"></a>         <span class="at">Closely_follow =</span> <span class="fu">factor</span>(Closely_follow,</span>
<span id="cb21-12"><a href="#cb21-12"></a>                                 <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb21-13"><a href="#cb21-13"></a>                                 <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Followed it somewhat"</span>, <span class="st">"Followed it exactly"</span>)),</span>
<span id="cb21-14"><a href="#cb21-14"></a>         <span class="at">Research_exp =</span> <span class="fu">factor</span>(Research_exp),</span>
<span id="cb21-15"><a href="#cb21-15"></a>         <span class="at">Pre_reg_group =</span> <span class="fu">factor</span>(Pre_reg_group))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="appropriate-plots" class="level2 unnumbered"><h2 class="unnumbered anchored" data-anchor-id="appropriate-plots">Appropriate plots?</h2>
<p>Now we can think about which plot is the appropriate plot for your data. Different types of variables require different types of plots, so this comes back to how many variables are you aiming to plot and what kind of data type are they. The following part is organised by type of variable.</p>
<p>Today, we will focus on plots for categorical data. Next week, we’ll cover plots for continuous variables and discover which plots are appropriate if you have a mix of continuous and categorical variables</p>
</section><section id="one-categorical-variable" class="level2" data-number="4.4"><h2 data-number="4.4" class="anchored" data-anchor-id="one-categorical-variable">
<span class="header-section-number">4.4</span> One categorical variable</h2>
<section id="barchart-geom_bar" class="level3" data-number="4.4.1"><h3 data-number="4.4.1" class="anchored" data-anchor-id="barchart-geom_bar">
<span class="header-section-number">4.4.1</span> Barchart (<code>geom_bar()</code>)</h3>
<p>Let’s say we want to count some demographics. To keep it simple, we want to show gender counts. We would use a <strong>barplot</strong> for it. This is done with <code>geom_bar()</code> in your third layer, and because the counting is done in the background, the <code>aes</code> only requires an x value (i.e.&nbsp;the name of your variable).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="fu">ggplot</span>(data_prp_viz, <span class="fu">aes</span>(<span class="at">x =</span> Gender)) <span class="sc">+</span></span>
<span id="cb22-2"><a href="#cb22-2"></a>  <span class="fu">geom_bar</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-bc-base" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="04-dataviz_files/figure-html/fig-bc-base-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;4.1: Default barchart</figcaption></figure>
</div>
</div>
</div>
<p>This is the base plot done. You can customise it by adding different layers. For example, the labels aren’t super clear or it could do with a dash of colour. Click on the tabs below to see examples of what could be added and practice on your base plot in your own Rmd.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Colour</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Axes labels &amp; margins</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">Legend</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" role="tab" aria-controls="tabset-2-4" aria-selected="false">Themes</a></li>
</ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p>We can change the colour by adding a fill argument in the <code>aes()</code>. If we want to modify these colours further, we would add a <code>scale_fill_?</code> argument. If you have specific colours in mind, you would use <code>scale_fill_manual()</code> or if you want to stick with pre-defined ones, like viridis, use <code>scale_fill_viridis_d()</code></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="fu">ggplot</span>(data_prp_viz, <span class="fu">aes</span>(<span class="at">x =</span> Gender, <span class="at">fill =</span> Gender)) <span class="sc">+</span></span>
<span id="cb23-2"><a href="#cb23-2"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb23-3"><a href="#cb23-3"></a>  <span class="co"># customise colour</span></span>
<span id="cb23-4"><a href="#cb23-4"></a>  <span class="fu">scale_fill_viridis_d</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="04-dataviz_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p>The x-axis label is fine, but the categories need to be relabeled. You can achieve that with the <code>scale_x_discrete()</code> function and the argument <code>labels =</code>. But make sure you order them in the order of the labels in the dataframe.</p>
<p>There is also this gap between bottom of the chart and the bars which seems a bit weird. We can remove that with an <code>expansion()</code> function.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="fu">ggplot</span>(data_prp_viz, <span class="fu">aes</span>(<span class="at">x =</span> Gender, <span class="at">fill =</span> Gender)) <span class="sc">+</span></span>
<span id="cb24-2"><a href="#cb24-2"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb24-3"><a href="#cb24-3"></a>  <span class="fu">scale_fill_viridis_d</span>() <span class="sc">+</span></span>
<span id="cb24-4"><a href="#cb24-4"></a>  <span class="co"># changing group labels on the breaks of the x axis</span></span>
<span id="cb24-5"><a href="#cb24-5"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Female"</span>, <span class="st">"Male"</span>, <span class="st">"Non-Binary"</span>)) <span class="sc">+</span> </span>
<span id="cb24-6"><a href="#cb24-6"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb24-7"><a href="#cb24-7"></a>    <span class="co"># changing name of the y axis</span></span>
<span id="cb24-8"><a href="#cb24-8"></a>    <span class="at">name =</span> <span class="st">"Count"</span>,</span>
<span id="cb24-9"><a href="#cb24-9"></a>    <span class="co"># remove the space below the bars (first number), but keep a tiny bit (5%) above (second number)</span></span>
<span id="cb24-10"><a href="#cb24-10"></a>    <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>))</span>
<span id="cb24-11"><a href="#cb24-11"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="04-dataviz_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<p>The legend does not add any information because the labels are already provided on the x axis. We can remove the legend by adding the argument <code>guide = "none"</code> into the <code>scale_fill</code> function.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="fu">ggplot</span>(data_prp_viz, <span class="fu">aes</span>(<span class="at">x =</span> Gender, <span class="at">fill =</span> Gender)) <span class="sc">+</span></span>
<span id="cb25-2"><a href="#cb25-2"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb25-3"><a href="#cb25-3"></a>  <span class="fu">scale_fill_viridis_d</span>(</span>
<span id="cb25-4"><a href="#cb25-4"></a>    <span class="co"># remove the legend</span></span>
<span id="cb25-5"><a href="#cb25-5"></a>    <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb25-6"><a href="#cb25-6"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Female"</span>, <span class="st">"Male"</span>, <span class="st">"Non-Binary"</span>)) <span class="sc">+</span></span>
<span id="cb25-7"><a href="#cb25-7"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb25-8"><a href="#cb25-8"></a>    <span class="at">name =</span> <span class="st">"Count"</span>,</span>
<span id="cb25-9"><a href="#cb25-9"></a>    <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>))</span>
<span id="cb25-10"><a href="#cb25-10"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="04-dataviz_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-4-tab">
<p>Let’s experiment with the themes. For this plot we have chosen <code>theme_minimal()</code></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="fu">ggplot</span>(data_prp_viz, <span class="fu">aes</span>(<span class="at">x =</span> Gender, <span class="at">fill =</span> Gender)) <span class="sc">+</span></span>
<span id="cb26-2"><a href="#cb26-2"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb26-3"><a href="#cb26-3"></a>  <span class="fu">scale_fill_viridis_d</span>(</span>
<span id="cb26-4"><a href="#cb26-4"></a>    <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb26-5"><a href="#cb26-5"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Female"</span>, <span class="st">"Male"</span>, <span class="st">"Non-Binary"</span>)) <span class="sc">+</span></span>
<span id="cb26-6"><a href="#cb26-6"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb26-7"><a href="#cb26-7"></a>    <span class="at">name =</span> <span class="st">"Count"</span>,</span>
<span id="cb26-8"><a href="#cb26-8"></a>    <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>))</span>
<span id="cb26-9"><a href="#cb26-9"></a>  ) <span class="sc">+</span></span>
<span id="cb26-10"><a href="#cb26-10"></a>  <span class="co"># pick a theme</span></span>
<span id="cb26-11"><a href="#cb26-11"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="04-dataviz_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section id="column-plot-geom_col" class="level3" data-number="4.4.2"><h3 data-number="4.4.2" class="anchored" data-anchor-id="column-plot-geom_col">
<span class="header-section-number">4.4.2</span> Column plot (<code>geom_col()</code>)</h3>
<p>If someone had already summarised those counts for you, you would not be able to use <code>geom_bar()</code>. In that case, you would switch to <code>geom_col()</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>gender_count <span class="ot">&lt;-</span> data_prp_viz <span class="sc">%&gt;%</span> </span>
<span id="cb27-2"><a href="#cb27-2"></a>  <span class="fu">count</span>(Gender)</span>
<span id="cb27-3"><a href="#cb27-3"></a></span>
<span id="cb27-4"><a href="#cb27-4"></a>gender_count</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">Gender</th>
<th style="text-align: right;">n</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">females</td>
<td style="text-align: right;">69</td>
</tr>
<tr class="even">
<td style="text-align: left;">males</td>
<td style="text-align: right;">17</td>
</tr>
<tr class="odd">
<td style="text-align: left;">non-binary</td>
<td style="text-align: right;">3</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>The mapping for <code>geom_col()</code> requires both an <strong>x</strong> and a <strong>y</strong> aesthetics. In our example, x would be our categorical variable (e.g., <code>Gender</code>), and y would be the column name that stored the values (<code>n</code>). Note how the base version has now n as an axis title (instead of count).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="fu">ggplot</span>(gender_count, <span class="fu">aes</span>(<span class="at">x =</span> Gender, <span class="at">y =</span> n, <span class="at">fill =</span> Gender)) <span class="sc">+</span></span>
<span id="cb28-2"><a href="#cb28-2"></a>  <span class="fu">geom_col</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-col" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="04-dataviz_files/figure-html/fig-col-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;4.2: Column plot with different coloured bars</figcaption></figure>
</div>
</div>
</div>
</section><section id="activity-3-make-the-column-plot-pretty" class="level3" data-number="4.4.3"><h3 data-number="4.4.3" class="anchored" data-anchor-id="activity-3-make-the-column-plot-pretty">
<span class="header-section-number">4.4.3</span> Activity 3: Make the column plot pretty</h3>
<p>The other layers to change the colour scheme, axes labels and margins, removing the legend and altering the theme require exactly the same functions as with the boxplot above. Test yourself to see if you could…</p>
<ul class="task-list">
<li>
<input type="checkbox">change the colour scheme (e.g., viridis or <a href="https://www.datanovia.com/en/blog/the-a-z-of-rcolorbrewer-palette/" target="_blank">any other colour palettes</a>)</li>
<li>
<input type="checkbox">remove the legend</li>
<li>
<input type="checkbox">change the title of the x and y axes</li>
<li>
<input type="checkbox">make the bars start directly on the x axis</li>
<li>
<input type="checkbox">add a theme of your linking</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Possible solution code for the column plot (with a different colour palette and a different theme)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="fu">ggplot</span>(gender_count, <span class="fu">aes</span>(<span class="at">x =</span> Gender, <span class="at">y =</span> n, <span class="at">fill =</span> Gender)) <span class="sc">+</span></span>
<span id="cb29-2"><a href="#cb29-2"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb29-3"><a href="#cb29-3"></a>  <span class="co"># replaced vidiris with the brewer palette</span></span>
<span id="cb29-4"><a href="#cb29-4"></a>  <span class="fu">scale_fill_brewer</span>(</span>
<span id="cb29-5"><a href="#cb29-5"></a>    <span class="at">palette =</span> <span class="st">"Set1"</span>, <span class="co"># try "Set2" or "Dark2" for some variety</span></span>
<span id="cb29-6"><a href="#cb29-6"></a>    <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span> <span class="co"># legend removed</span></span>
<span id="cb29-7"><a href="#cb29-7"></a>  <span class="co"># labels of the categories changed</span></span>
<span id="cb29-8"><a href="#cb29-8"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Male"</span>, <span class="st">"Female"</span>, <span class="st">"Non-Binary"</span>)) <span class="sc">+</span> </span>
<span id="cb29-9"><a href="#cb29-9"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb29-10"><a href="#cb29-10"></a>    <span class="co"># change y axis label</span></span>
<span id="cb29-11"><a href="#cb29-11"></a>    <span class="at">name =</span> <span class="st">"Count"</span>,</span>
<span id="cb29-12"><a href="#cb29-12"></a>    <span class="co"># starts bars on x axis without any gaps but leaves some space at the top (this time 10%)</span></span>
<span id="cb29-13"><a href="#cb29-13"></a>    <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>)) </span>
<span id="cb29-14"><a href="#cb29-14"></a>  ) <span class="sc">+</span></span>
<span id="cb29-15"><a href="#cb29-15"></a>  <span class="co"># different theme</span></span>
<span id="cb29-16"><a href="#cb29-16"></a>  <span class="fu">theme_light</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="04-dataviz_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section></section><section id="two-categorical-variables" class="level2" data-number="4.5"><h2 data-number="4.5" class="anchored" data-anchor-id="two-categorical-variables">
<span class="header-section-number">4.5</span> Two categorical variables</h2>
<p>For this task, we can look at the variable <code>Plan_prereg</code> measuring whether they planned to pre-register their undergraduate dissertation at time point 1, and <code>Pre_reg_group</code> whether they actually ended up doing a pre-registration for their undergraduate dissertations.</p>
<section id="stacked-and-percent-stacked-barchart" class="level3" data-number="4.5.1"><h3 data-number="4.5.1" class="anchored" data-anchor-id="stacked-and-percent-stacked-barchart">
<span class="header-section-number">4.5.1</span> Stacked and percent stacked barchart</h3>
<p>One way to display that data is by creating a <strong>Stacked barchart</strong> (default option) or a <strong>Percent stacked barchart</strong>. For both options, the subgroups are displayed on top of each other. To show the two plots next to each other for better comparison, we moved the legend to the bottom of the chart.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="do">## Stacked barchart</span></span>
<span id="cb30-2"><a href="#cb30-2"></a><span class="fu">ggplot</span>(data_prp_viz, <span class="fu">aes</span>(<span class="at">x =</span> Plan_prereg, <span class="at">fill =</span> Pre_reg_group)) <span class="sc">+</span></span>
<span id="cb30-3"><a href="#cb30-3"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span> <span class="co"># no position argument added</span></span>
<span id="cb30-4"><a href="#cb30-4"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="co"># move legend to the bottom</span></span>
<span id="cb30-5"><a href="#cb30-5"></a></span>
<span id="cb30-6"><a href="#cb30-6"></a><span class="do">## Percent stacked barchart</span></span>
<span id="cb30-7"><a href="#cb30-7"></a><span class="fu">ggplot</span>(data_prp_viz, <span class="fu">aes</span>(<span class="at">x =</span> Plan_prereg, <span class="at">fill =</span> Pre_reg_group)) <span class="sc">+</span></span>
<span id="cb30-8"><a href="#cb30-8"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span> <span class="co"># add position argument here</span></span>
<span id="cb30-9"><a href="#cb30-9"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="co"># move legend to the bottom</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-barcharts_stacked" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="04-dataviz_files/figure-html/fig-barcharts_stacked-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;4.3: Stacked barchart (left), and Percent stacked barchart (right)</figcaption></figure>
</div>
</div>
</div>
<p>In the <strong>stacked barchart</strong> (<a href="#fig-barcharts_stacked">Figure&nbsp;<span>4.3</span></a>, left plot), you are able to plot participant numbers. Here we can see that the highest student number were unsure whether they wanted to pre-register their dissertation or not, followed closely by participants who answered yes. We can also see that the number of people who did not end up with a pre-registered dissertation (blue category) is the same for students who had planned to pre-register and those who did not want to pre-register. However, because <code>No</code> has quite a lower number than the other two categories, we are having a tough time seeing whether the ratio is the same across all 3 groups.</p>
<p>If we wanted to show that, a <strong>Percent stacked barchart</strong> (<a href="#fig-barcharts_stacked">Figure&nbsp;<span>4.3</span></a>, right plot) would make a lot more sense. Now we would see that approximately 80% of the students who wanted to pre-register their dissertations, 50% of the students who were initially unsure, and only 33% of the students who had no pre-registration plans ended up with a ended up with a pre-registered dissertation. BUT! We would lose the information about the raw values in the sample.</p>
<p><strong>It’s all a trade-off and the plot you choose depends on which “story” of the data you want to tell.</strong></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The position argument <code>position = "stack"</code> is the default. Adding this argument to the code for the left plot in <a href="#fig-barcharts_stacked">Figure&nbsp;<span>4.3</span></a> would produce the same plot a leaving the argument out.</p>
</div>
</div>
</section><section id="grouped-barchart" class="level3" data-number="4.5.2"><h3 data-number="4.5.2" class="anchored" data-anchor-id="grouped-barchart">
<span class="header-section-number">4.5.2</span> Grouped barchart</h3>
<p>A second option is a <strong>Grouped barchart</strong> which displays the bars next to each other. We would achieve that by changing the position argument to <strong>“dogde”</strong>. You can see the default version of the plot in the <a href="#fig-barchart_grouped">Figure&nbsp;<span>4.4</span></a> on the left, and one with more layers on the right.</p>
<p>Instead of using an existing colour palette, we changed the colours manually using hex codes. These are some of the colours Gaby used in her PhD, but you can either</p>
<ul>
<li>create your own colour hex codes; check out <a href="https://www.hexcolortool.com/" target="_blank">this website</a> OR</li>
<li>use a pre-defined colour name like “green” or “purple instead. See a full list <a href="https://www.datanovia.com/en/blog/awesome-list-of-657-r-color-names/" target="_blank">here</a>
</li>
</ul>
<p>Feel free to explore.</p>
<p>Since the legend title for the second plot is a bit long, we displayed the legend content across 2 rows by adding the layer <code>guides(fill = guide_legend(nrow = 2))</code> at the end.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="do">## Default grouped barchart</span></span>
<span id="cb31-2"><a href="#cb31-2"></a><span class="fu">ggplot</span>(data_prp_viz, <span class="fu">aes</span>(<span class="at">x =</span> Plan_prereg, <span class="at">fill =</span> Pre_reg_group)) <span class="sc">+</span></span>
<span id="cb31-3"><a href="#cb31-3"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span> <span class="co"># add position argument here</span></span>
<span id="cb31-4"><a href="#cb31-4"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="co"># move legend to the bottom</span></span>
<span id="cb31-5"><a href="#cb31-5"></a></span>
<span id="cb31-6"><a href="#cb31-6"></a><span class="do">## Prettier grouped barchart</span></span>
<span id="cb31-7"><a href="#cb31-7"></a><span class="fu">ggplot</span>(data_prp_viz, <span class="fu">aes</span>(<span class="at">x =</span> Plan_prereg, <span class="at">fill =</span> Pre_reg_group)) <span class="sc">+</span></span>
<span id="cb31-8"><a href="#cb31-8"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span> <span class="co"># add position argument here</span></span>
<span id="cb31-9"><a href="#cb31-9"></a>  <span class="co"># changing labels for x, y, and fill category - alternative method</span></span>
<span id="cb31-10"><a href="#cb31-10"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Pre-registration planned"</span>, <span class="at">y =</span> <span class="st">"Count"</span>, <span class="at">fill =</span> <span class="st">"Pre-registered dissertation"</span>) <span class="sc">+</span></span>
<span id="cb31-11"><a href="#cb31-11"></a>  <span class="co"># manual colour change for values</span></span>
<span id="cb31-12"><a href="#cb31-12"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">'#648FFF'</span>, <span class="st">'#DC267F'</span>),</span>
<span id="cb31-13"><a href="#cb31-13"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Yes"</span>, <span class="st">"No"</span>)) <span class="sc">+</span></span>
<span id="cb31-14"><a href="#cb31-14"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb31-15"><a href="#cb31-15"></a>    <span class="co"># remove the space below the bars, but keep a tiny bit (5%) above</span></span>
<span id="cb31-16"><a href="#cb31-16"></a>    <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>))</span>
<span id="cb31-17"><a href="#cb31-17"></a>  ) <span class="sc">+</span></span>
<span id="cb31-18"><a href="#cb31-18"></a>  <span class="co"># pick a theme</span></span>
<span id="cb31-19"><a href="#cb31-19"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb31-20"><a href="#cb31-20"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span> <span class="co"># need to move this part to the end otherwise the `theme_*` overrides it</span></span>
<span id="cb31-21"><a href="#cb31-21"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">2</span>)) <span class="co"># display legend categories across 2 rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-barchart_grouped" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="04-dataviz_files/figure-html/fig-barchart_grouped-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;4.4: Default grouped barchart (left) and one with a few more layers added (right)</figcaption></figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Special case: Categorical variables with missing values
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>If we had chosen a different categorical variable containing missing values, such as <code>Closely_follow</code> then our plots would have included those missing values by default. The code for changing the colour of the missing values columns would need to be specified slightly differently using an <code>na.value =</code> argument within the <code>scale_fill</code> function. Here is an example of a grouped barchart.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="co"># default grouped barchart with missing values</span></span>
<span id="cb32-2"><a href="#cb32-2"></a><span class="fu">ggplot</span>(data_prp_viz, <span class="fu">aes</span>(<span class="at">x =</span> Plan_prereg, <span class="at">fill =</span> Closely_follow)) <span class="sc">+</span></span>
<span id="cb32-3"><a href="#cb32-3"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span> </span>
<span id="cb32-4"><a href="#cb32-4"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span> </span>
<span id="cb32-5"><a href="#cb32-5"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">3</span>)) <span class="co"># display across 3 rows</span></span>
<span id="cb32-6"><a href="#cb32-6"></a></span>
<span id="cb32-7"><a href="#cb32-7"></a><span class="do">## Prettier grouped barchart with missing values</span></span>
<span id="cb32-8"><a href="#cb32-8"></a><span class="fu">ggplot</span>(data_prp_viz, <span class="fu">aes</span>(<span class="at">x =</span> Plan_prereg, <span class="at">fill =</span> Closely_follow)) <span class="sc">+</span></span>
<span id="cb32-9"><a href="#cb32-9"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span> </span>
<span id="cb32-10"><a href="#cb32-10"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Pre-registration planned"</span>, <span class="at">y =</span> <span class="st">"Count"</span>, <span class="at">fill =</span> <span class="st">"Pre-registration followed"</span>) <span class="sc">+</span></span>
<span id="cb32-11"><a href="#cb32-11"></a>  <span class="co"># manual colour change for values of the factor and the NA responses</span></span>
<span id="cb32-12"><a href="#cb32-12"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">'#648FFF'</span>, <span class="st">'#DC267F'</span>), <span class="at">na.value =</span> <span class="st">'#FFB000'</span>) <span class="sc">+</span></span>
<span id="cb32-13"><a href="#cb32-13"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb32-14"><a href="#cb32-14"></a>    <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>))</span>
<span id="cb32-15"><a href="#cb32-15"></a>  ) <span class="sc">+</span></span>
<span id="cb32-16"><a href="#cb32-16"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb32-17"><a href="#cb32-17"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span> </span>
<span id="cb32-18"><a href="#cb32-18"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">3</span>)) <span class="co"># display across 3 rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-barchart_grouped_na" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="04-dataviz_files/figure-html/fig-barchart_grouped_na-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;4.5: Default grouped barchart (left) and one with a few more layers added (right) for a variable with missing values</figcaption></figure>
</div>
</div>
</div>
<p>If you did not want those missing values to appear in the plot, you would have to do some data wrangling first to remove them. The function for that is <code>drop_na()</code>. Here we used <code>drop_na()</code> on <code>Closely_follow</code> only.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="co"># remove NA</span></span>
<span id="cb33-2"><a href="#cb33-2"></a>prereg_plan_follow <span class="ot">&lt;-</span> data_prp_viz <span class="sc">%&gt;%</span> </span>
<span id="cb33-3"><a href="#cb33-3"></a>  <span class="fu">select</span>(Code, Plan_prereg, Closely_follow) <span class="sc">%&gt;%</span> </span>
<span id="cb33-4"><a href="#cb33-4"></a>  <span class="fu">drop_na</span>(Closely_follow)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
check NAs have been removed
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="co"># check NA have been removed</span></span>
<span id="cb34-2"><a href="#cb34-2"></a>prereg_plan_follow <span class="sc">%&gt;%</span> </span>
<span id="cb34-3"><a href="#cb34-3"></a>  <span class="fu">distinct</span>(Plan_prereg, Closely_follow) <span class="sc">%&gt;%</span> </span>
<span id="cb34-4"><a href="#cb34-4"></a>  <span class="fu">arrange</span>(Plan_prereg, Closely_follow)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">Plan_prereg</th>
<th style="text-align: left;">Closely_follow</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Followed it somewhat</td>
</tr>
<tr class="even">
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Followed it exactly</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Unsure</td>
<td style="text-align: left;">Followed it somewhat</td>
</tr>
<tr class="even">
<td style="text-align: left;">Unsure</td>
<td style="text-align: left;">Followed it exactly</td>
</tr>
<tr class="odd">
<td style="text-align: left;">No</td>
<td style="text-align: left;">Followed it somewhat</td>
</tr>
<tr class="even">
<td style="text-align: left;">No</td>
<td style="text-align: left;">Followed it exactly</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<p>But keep in mind that it could misrepresent the data, e.g., giving a wrong impression about proportions. As a comparison…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="co"># with NA</span></span>
<span id="cb35-2"><a href="#cb35-2"></a><span class="fu">ggplot</span>(data_prp_viz, <span class="fu">aes</span>(<span class="at">x =</span> Plan_prereg, <span class="at">fill =</span> Closely_follow)) <span class="sc">+</span></span>
<span id="cb35-3"><a href="#cb35-3"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span> <span class="co"># add position argument here</span></span>
<span id="cb35-4"><a href="#cb35-4"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span> <span class="co"># move legend to the bottom</span></span>
<span id="cb35-5"><a href="#cb35-5"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">2</span>)) <span class="co"># display across 2 rows</span></span>
<span id="cb35-6"><a href="#cb35-6"></a></span>
<span id="cb35-7"><a href="#cb35-7"></a><span class="co"># without NA</span></span>
<span id="cb35-8"><a href="#cb35-8"></a><span class="fu">ggplot</span>(prereg_plan_follow, <span class="fu">aes</span>(<span class="at">x =</span> Plan_prereg, <span class="at">fill =</span> Closely_follow)) <span class="sc">+</span></span>
<span id="cb35-9"><a href="#cb35-9"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span> <span class="co"># add position argument here</span></span>
<span id="cb35-10"><a href="#cb35-10"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span> <span class="co"># move legend to the bottom</span></span>
<span id="cb35-11"><a href="#cb35-11"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">2</span>)) <span class="co"># display across 2 rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-barchart_na_no_na" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="04-dataviz_files/figure-html/fig-barchart_na_no_na-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;4.6: Percent stacked barchart with (left) and without missing values (right)</figcaption></figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section></section><section id="activity-4-save-your-plots" class="level2" data-number="4.6"><h2 data-number="4.6" class="anchored" data-anchor-id="activity-4-save-your-plots">
<span class="header-section-number">4.6</span> Activity 4: Save your plots</h2>
<p>You can save your figures with the function <code>ggsave()</code>. It will save to your project folder.</p>
<p>There are two ways you can use <code>ggsave()</code>. If you don’t tell <code>ggsave()</code> which plot you want to save, by <strong>default</strong> it will <strong>save the last plot you created</strong>. Our last plot was the one without <code>NA</code> from the special case scenario (<a href="#fig-barchart_na_no_na">Figure&nbsp;<span>4.6</span></a>). However, if you did not follow along with the special case scenario, your last plot will be grouped bar chart on the right from <a href="#fig-barchart_grouped">Figure&nbsp;<span>4.4</span></a>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"last_plot.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Our last plot saved
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><img src="images/last_plot.png" class="img-fluid"></p>
</div>
</div>
</div>
<p>The second option is to save the plot as an object and refer to the object within <code>ggsave()</code>. As an example, let’s save the grouped barchart that contained missing values (<a href="#fig-barchart_grouped">Figure&nbsp;<span>4.4</span></a>) as an object called <code>grouped_bar</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>grouped_bar <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_prp_viz, <span class="fu">aes</span>(<span class="at">x =</span> Plan_prereg, <span class="at">fill =</span> Closely_follow)) <span class="sc">+</span></span>
<span id="cb37-2"><a href="#cb37-2"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span> </span>
<span id="cb37-3"><a href="#cb37-3"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Pre-registration planned"</span>, <span class="at">y =</span> <span class="st">"Count"</span>, <span class="at">fill =</span> <span class="st">"Pre-registration followed"</span>) <span class="sc">+</span></span>
<span id="cb37-4"><a href="#cb37-4"></a>  <span class="co"># manual colour change for values of the factor and the NA responses</span></span>
<span id="cb37-5"><a href="#cb37-5"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">'#648FFF'</span>, <span class="st">'#DC267F'</span>), <span class="at">na.value =</span> <span class="st">'#FFB000'</span>) <span class="sc">+</span></span>
<span id="cb37-6"><a href="#cb37-6"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb37-7"><a href="#cb37-7"></a>    <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>))</span>
<span id="cb37-8"><a href="#cb37-8"></a>  ) <span class="sc">+</span></span>
<span id="cb37-9"><a href="#cb37-9"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb37-10"><a href="#cb37-10"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span> </span>
<span id="cb37-11"><a href="#cb37-11"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">3</span>)) <span class="co"># display across 3 rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then you run the line</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"grouped_bar.png"</span>, </span>
<span id="cb38-2"><a href="#cb38-2"></a>       <span class="at">plot =</span> grouped_bar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
</div>
<p>Filename is the name you want your png to be called, plot refers to the object name.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Our saved <code>grouped_bar.png</code> would look like this:
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><img src="images/grouped_bar.png" class="img-fluid"></p>
</div>
</div>
</div>
<p>That is with default settings. If you like it, keep it, but if you think it looks a bit “stretched”, you can specify the width, the height, and the units (e.g., “cm”, “mm”, “in”, “px” are possible). You might need to play about with the dimension before it feels right.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"grouped_bar2.png"</span>, </span>
<span id="cb40-2"><a href="#cb40-2"></a>       <span class="at">plot =</span> grouped_bar, </span>
<span id="cb40-3"><a href="#cb40-3"></a>       <span class="at">width =</span> <span class="dv">16</span>, <span class="at">height =</span> <span class="dv">9</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
png with different dimensions
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><img src="images/grouped_bar2.png" class="img-fluid"></p>
</div>
</div>
</div>
</section><section id="activity-5-your-turn" class="level2" data-number="4.7"><h2 data-number="4.7" class="anchored" data-anchor-id="activity-5-your-turn">
<span class="header-section-number">4.7</span> Activity 5: Your Turn</h2>
<p>Pick <strong>any single or two categorical variables</strong> from the dataset and <strong>choose one of the appropriate plot choices</strong>. Start with a base plot and add other layers if you please.</p>
<p>Save your plot and share it with us on Teams.</p>
</section><section id="pair-coding-in-the-lab" class="level2 unnumbered"><h2 class="unnumbered anchored" data-anchor-id="pair-coding-in-the-lab"><span style="color: #F39C12; text-transform: uppercase;">Pair-coding in the lab</span></h2>
<p>Provide a barchart, a violin-boxplot, and a scatterplot from the loneliness data and the students have to try and recreate one of those in the lab. If they are overly fast, they can do the other 2.</p>
</section><section id="test-your-knowledge" class="level2 unnumbered"><h2 class="unnumbered anchored" data-anchor-id="test-your-knowledge"><span style="color: #F39C12; text-transform: uppercase;">Test your knowledge</span></h2>
<p>Which plot would you choose for</p>


</section></main><!-- /main --><script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  var t = document.getElementsByClassName("webex-total_correct");
  for (var i = 0; i < t.length; i++) {
    p = t[i].parentElement;
    var correct = p.getElementsByClassName("webex-correct").length;
    var solvemes = p.getElementsByClassName("webex-solveme").length;
    var radiogroups = p.getElementsByClassName("webex-radiogroup").length;
    var selects = p.getElementsByClassName("webex-select").length;

    t[i].innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");

  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* check answers */
check_func = function() {
  console.log("webex: check answers");

  var cl = this.parentElement.classList;
  if (cl.contains('unchecked')) {
    cl.remove("unchecked");
    this.innerHTML = "Hide Answers";
  } else {
    cl.add("unchecked");
    this.innerHTML = "Show Answers";
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");

  var cl = this.classList

  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;

  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }

  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

window.onload = function() {
  console.log("webex onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  var check_sections = document.getElementsByClassName("webex-check");
  console.log("check:", check_sections.length);
  for (var i = 0; i < check_sections.length; i++) {
    check_sections[i].classList.add("unchecked");

    let btn = document.createElement("button");
    btn.innerHTML = "Show Answers";
    btn.classList.add("webex-check-button");
    btn.onclick = check_func;
    check_sections[i].appendChild(btn);

    let spn = document.createElement("span");
    spn.classList.add("webex-total_correct");
    check_sections[i].appendChild(spn);
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;

    solveme[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }

  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
    selects[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  update_total_correct();
}

</script><script>
// open rdrr links externally ----

var exlinks = document.querySelectorAll("a[href^='https://rdrr.io']");
var exlink_func = function(){
  window.open(this.href);
  return false;
};
for (var i = 0; i < exlinks.length; i++) {
    exlinks[i].addEventListener('click', exlink_func, false);
}

// visible second sidebar in mobile ----

function move_sidebar() {
  var toc = document.getElementById("TOC");
  var small_sidebar = document.querySelector("#quarto-sidebar .sidebar-menu-container");
  var right_sidebar = document.getElementById("quarto-margin-sidebar");

  if (window.innerWidth < 768) {
    small_sidebar.append(toc);
  } else {
    right_sidebar.append(toc);
  }
}
move_sidebar();
window.onresize = move_sidebar;
</script><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./03-wrangling2.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data wrangling</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./05-dataviz2.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Data viz II</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">CC-BY (2024) Gaby Mahrholz</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>


</body></html>